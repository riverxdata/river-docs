<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">Working with Remote Files using bcftools and samtools (HTSlib) | RiverXData</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://riverxdata.github.io/river-docs/blog/remote-files-htslib-bcftools-samtools"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" name="keywords" content="bioinformatics, data, infrastructure, hpc, cloud"><meta data-rh="true" name="author" content="RiverXData Team"><meta data-rh="true" property="og:title" content="Working with Remote Files using bcftools and samtools (HTSlib) | RiverXData"><meta data-rh="true" name="description" content="HTSlib-based tools like bcftools and samtools provide powerful capabilities for working with genomic data stored on remote servers. Whether your data is in AWS S3, accessible via FTP, or hosted on HTTPS endpoints, these tools allow you to efficiently query and subset remote files without downloading entire datasets. This guide covers authentication, remote file access patterns, and practical workflows."><meta data-rh="true" property="og:description" content="HTSlib-based tools like bcftools and samtools provide powerful capabilities for working with genomic data stored on remote servers. Whether your data is in AWS S3, accessible via FTP, or hosted on HTTPS endpoints, these tools allow you to efficiently query and subset remote files without downloading entire datasets. This guide covers authentication, remote file access patterns, and practical workflows."><meta data-rh="true" property="og:image" content="https://riverxdata.github.io/river-docs/assets/images/intro-7aaa912f8e48c1bb524eacaf56d8a3cd.png"><meta data-rh="true" name="twitter:image" content="https://riverxdata.github.io/river-docs/assets/images/intro-7aaa912f8e48c1bb524eacaf56d8a3cd.png"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2026-02-16T00:00:00.000Z"><meta data-rh="true" property="article:author" content="https://www.facebook.com/nttg8100"><meta data-rh="true" property="article:tag" content="bioinformatics,htslib,bcftools,samtools,s3,remote-files,cloud,genomics"><link data-rh="true" rel="icon" href="/river-docs/img/logo-riverxdata-02.png"><link data-rh="true" rel="canonical" href="https://riverxdata.github.io/river-docs/blog/remote-files-htslib-bcftools-samtools"><link data-rh="true" rel="alternate" href="https://riverxdata.github.io/river-docs/blog/remote-files-htslib-bcftools-samtools" hreflang="en"><link data-rh="true" rel="alternate" href="https://riverxdata.github.io/river-docs/blog/remote-files-htslib-bcftools-samtools" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","@id":"https://riverxdata.github.io/river-docs/blog/remote-files-htslib-bcftools-samtools","mainEntityOfPage":"https://riverxdata.github.io/river-docs/blog/remote-files-htslib-bcftools-samtools","url":"https://riverxdata.github.io/river-docs/blog/remote-files-htslib-bcftools-samtools","headline":"Working with Remote Files using bcftools and samtools (HTSlib)","name":"Working with Remote Files using bcftools and samtools (HTSlib)","description":"HTSlib-based tools like bcftools and samtools provide powerful capabilities for working with genomic data stored on remote servers. Whether your data is in AWS S3, accessible via FTP, or hosted on HTTPS endpoints, these tools allow you to efficiently query and subset remote files without downloading entire datasets. This guide covers authentication, remote file access patterns, and practical workflows.","datePublished":"2026-02-16T00:00:00.000Z","author":{"@type":"Person","name":"Thanh-Giang Tan Nguyen","description":"Founder at RIVER","url":"https://www.facebook.com/nttg8100","email":"nttg8100@gmail.com","image":"https://avatars.githubusercontent.com/u/64969412?v=4"},"image":{"@type":"ImageObject","@id":"https://riverxdata.github.io/river-docs/assets/images/intro-7aaa912f8e48c1bb524eacaf56d8a3cd.png","url":"https://riverxdata.github.io/river-docs/assets/images/intro-7aaa912f8e48c1bb524eacaf56d8a3cd.png","contentUrl":"https://riverxdata.github.io/river-docs/assets/images/intro-7aaa912f8e48c1bb524eacaf56d8a3cd.png","caption":"title image for the blog post: Working with Remote Files using bcftools and samtools (HTSlib)"},"keywords":[],"isPartOf":{"@type":"Blog","@id":"https://riverxdata.github.io/river-docs/blog","name":"RiverXData Blog"}}</script><link rel="alternate" type="application/rss+xml" href="/river-docs/blog/rss.xml" title="RiverXData RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/river-docs/blog/atom.xml" title="RiverXData Atom Feed">





<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-0BBYTVWQV2"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-0BBYTVWQV2",{anonymize_ip:!0})</script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css" integrity="sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM" crossorigin="anonymous"><link rel="stylesheet" href="/river-docs/assets/css/styles.486b8637.css">
<script src="/river-docs/assets/js/runtime~main.714360e6.js" defer="defer"></script>
<script src="/river-docs/assets/js/main.9b8630df.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||"light"),document.documentElement.setAttribute("data-theme-choice",t||"light")}(),function(){try{const a=new URLSearchParams(window.location.search).entries();for(var[t,e]of a)if(t.startsWith("docusaurus-data-")){var n=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(n,e)}}catch(t){}}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus"><link rel="preload" as="image" href="/river-docs/img/logo-riverxdata-02.png"><link rel="preload" as="image" href="https://avatars.githubusercontent.com/u/64969412?v=4"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><div class="theme-announcement-bar announcementBar_mb4j" style="background-color:#667eea;color:#ffffff" role="banner"><div class="content_knG7 announcementBarContent_xLdY">Comming soon: Support us on GitHub Sponsors! ❤️</div></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/river-docs/"><div class="navbar__logo"><img src="/river-docs/img/logo-riverxdata-02.png" alt="RiverXData" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/river-docs/img/logo-riverxdata-02.png" alt="RiverXData" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div></a><a class="navbar__item navbar__link" href="/river-docs/docs/overview">Documentation</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/river-docs/blog">Blog</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://github.com/riverxdata/river" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="navbar__search searchBarContainer_NW3z" dir="ltr"><input placeholder="Search" aria-label="Search" class="navbar__search-input searchInput_YFbd" value=""><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="paper" style="width:95%;margin:auto;margin-top:50px"><div class="row" style="width:100%"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">All posts</div><div role="group"><h3 class="yearGroupHeading_rMGB">2026</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a aria-current="page" class="sidebarItemLink_mo7H sidebarItemLinkActive_I1ZP" href="/river-docs/blog/remote-files-htslib-bcftools-samtools">Working with Remote Files using bcftools and samtools (HTSlib)</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/river-docs/blog/setup-local-nextflow-training">Setting Up a Local Nextflow Training Environment with Code-Server and HPC</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/river-docs/blog/docker-out-docker-bioinformatics-web-apps">Docker Out of Docker: Running Interactive Web Applications for Data Analysis</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/river-docs/blog/containers-hpc-docker-singularity-apptainer">Containers on HPC: From Docker to Singularity and Apptainer</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/river-docs/blog/migrate-bash-nextflow-enterprise-pipeline">How to Migrate from In-House Pipelines to Enterprise-Level Workflows: A Proven 3-Step Validation Framework</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/river-docs/blog/unix-pipes-bioinformatics-streaming-data">Unix Pipes in Bioinformatics: How Streaming Data Reduces Memory and Storage</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/river-docs/blog/bioinformatics-containers-build-efficient-docker">Containers in Bioinformatics: Community Tooling and Efficient Docker Building</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/river-docs/blog/bioinformatics-containers-build-efficient-docker">Containers in Bioinformatics: Community Tooling and Efficient Docker Building</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/river-docs/blog/bioinformatics-workflow-template-ci-cd-best-practices">Bioinformatics Workflow Template: Standardizing Python Pipelines with Modular Design</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/river-docs/blog/cicd-bioinformatics-act-local-github-action">Running GitHub Actions Locally with act: 5x Faster Development</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/river-docs/blog/machine-learning-bioinformatics-part1-knn">Machine Learning in Bioinformatics Part 1: Building KNN from Scratch</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/river-docs/blog/intro-ai-ml-bioinformatics-applications">Introduction to AI/ML in Bioinformatics: Classification Models &amp; Evaluation</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/river-docs/blog/bioinformatics-computing-resource-optimization-part2">Bioinformatics Cost Optimization For Input Using Nextflow (Part 2)</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/river-docs/blog/bioinformatics-computing-resource-optimization-part1">Bioinformatics Cost Optimization for Computing Resources Using Nextflow (Part 1)</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/river-docs/blog/pixi-is-new-conda-based-era">Pixi- New conda era</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/river-docs/blog/how-to-version-control-git-bioinformatics-part-2">The Evolution of Version Control - CI/CD in bioinformatics (Part 2)</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/river-docs/blog/how-to-version-control-git-bioinformatics-part-1">The Evolution of Version Control - Git&#x27;s Role in Reproducible Bioinformatics (Part 1)</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/river-docs/blog/how-to-build-slurm-hpc-part-3">Building a Slurm HPC Cluster (Part 3) - Administration and Best Practices</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/river-docs/blog/how-to-build-slurm-hpc-part-2">Building a Slurm HPC Cluster (Part 2) - Scaling to Production with Ansible</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/river-docs/blog/how-to-build-slurm-hpc-part-1">Building a Slurm HPC Cluster (Part 1) - Single Node Setup and Fundamentals</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/river-docs/blog/river-platform-and-nextflow">RIVER- A Web Application to Run Nf-Core</a></li></ul></div></nav></aside><main class="col col--6"><article class=""><header><h1 class="title_f1Hy">Working with Remote Files using bcftools and samtools (HTSlib)</h1><div class="container_mt6G margin-vert--md"><time datetime="2026-02-16T00:00:00.000Z">February 16, 2026</time> · <!-- -->18 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--12 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a class="avatar__photo-link" href="/river-docs/blog/authors/river"><img class="avatar__photo authorImage_XqGP" src="https://avatars.githubusercontent.com/u/64969412?v=4" alt="Thanh-Giang Tan Nguyen"></a><div class="avatar__intro authorDetails_lV9A"><div class="avatar__name"><a href="/river-docs/blog/authors/river"><span class="authorName_yefp" translate="no">Thanh-Giang Tan Nguyen</span></a></div><small class="authorTitle_nd0D" title="Founder at RIVER">Founder at RIVER</small><div class="authorSocials_rSDt"><a href="https://www.linkedin.com/in/thanh-giang-tan-nguyen-761b28190/" target="_blank" rel="noopener noreferrer" class="authorSocialLink_owbf" title="LinkedIn"><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" preserveAspectRatio="xMidYMid" viewBox="0 0 256 256" style="--dark:#0a66c2;--light:#ffffffe6" class="authorSocialIcon_XYv3 linkedinSvg_FCgI"><path d="M218.123 218.127h-37.931v-59.403c0-14.165-.253-32.4-19.728-32.4-19.756 0-22.779 15.434-22.779 31.369v60.43h-37.93V95.967h36.413v16.694h.51a39.907 39.907 0 0 1 35.928-19.733c38.445 0 45.533 25.288 45.533 58.186l-.016 67.013ZM56.955 79.27c-12.157.002-22.014-9.852-22.016-22.009-.002-12.157 9.851-22.014 22.008-22.016 12.157-.003 22.014 9.851 22.016 22.008A22.013 22.013 0 0 1 56.955 79.27m18.966 138.858H37.95V95.967h37.97v122.16ZM237.033.018H18.89C8.58-.098.125 8.161-.001 18.471v219.053c.122 10.315 8.576 18.582 18.89 18.474h218.144c10.336.128 18.823-8.139 18.966-18.474V18.454c-.147-10.33-8.635-18.588-18.966-18.453"></path></svg></a><a href="https://github.com/nttg8100" target="_blank" rel="noopener noreferrer" class="authorSocialLink_owbf" title="GitHub"><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 256 250" preserveAspectRatio="xMidYMid" style="--dark:#000;--light:#fff" class="authorSocialIcon_XYv3 githubSvg_Uu4N"><path d="M128.001 0C57.317 0 0 57.307 0 128.001c0 56.554 36.676 104.535 87.535 121.46 6.397 1.185 8.746-2.777 8.746-6.158 0-3.052-.12-13.135-.174-23.83-35.61 7.742-43.124-15.103-43.124-15.103-5.823-14.795-14.213-18.73-14.213-18.73-11.613-7.944.876-7.78.876-7.78 12.853.902 19.621 13.19 19.621 13.19 11.417 19.568 29.945 13.911 37.249 10.64 1.149-8.272 4.466-13.92 8.127-17.116-28.431-3.236-58.318-14.212-58.318-63.258 0-13.975 5-25.394 13.188-34.358-1.329-3.224-5.71-16.242 1.24-33.874 0 0 10.749-3.44 35.21 13.121 10.21-2.836 21.16-4.258 32.038-4.307 10.878.049 21.837 1.47 32.066 4.307 24.431-16.56 35.165-13.12 35.165-13.12 6.967 17.63 2.584 30.65 1.255 33.873 8.207 8.964 13.173 20.383 13.173 34.358 0 49.163-29.944 59.988-58.447 63.157 4.591 3.972 8.682 11.762 8.682 23.704 0 17.126-.148 30.91-.148 35.126 0 3.407 2.304 7.398 8.792 6.14C219.37 232.5 256 184.537 256 128.002 256 57.307 198.691 0 128.001 0Zm-80.06 182.34c-.282.636-1.283.827-2.194.39-.929-.417-1.45-1.284-1.15-1.922.276-.655 1.279-.838 2.205-.399.93.418 1.46 1.293 1.139 1.931Zm6.296 5.618c-.61.566-1.804.303-2.614-.591-.837-.892-.994-2.086-.375-2.66.63-.566 1.787-.301 2.626.591.838.903 1 2.088.363 2.66Zm4.32 7.188c-.785.545-2.067.034-2.86-1.104-.784-1.138-.784-2.503.017-3.05.795-.547 2.058-.055 2.861 1.075.782 1.157.782 2.522-.019 3.08Zm7.304 8.325c-.701.774-2.196.566-3.29-.49-1.119-1.032-1.43-2.496-.726-3.27.71-.776 2.213-.558 3.315.49 1.11 1.03 1.45 2.505.701 3.27Zm9.442 2.81c-.31 1.003-1.75 1.459-3.199 1.033-1.448-.439-2.395-1.613-2.103-2.626.301-1.01 1.747-1.484 3.207-1.028 1.446.436 2.396 1.602 2.095 2.622Zm10.744 1.193c.036 1.055-1.193 1.93-2.715 1.95-1.53.034-2.769-.82-2.786-1.86 0-1.065 1.202-1.932 2.733-1.958 1.522-.03 2.768.818 2.768 1.868Zm10.555-.405c.182 1.03-.875 2.088-2.387 2.37-1.485.271-2.861-.365-3.05-1.386-.184-1.056.893-2.114 2.376-2.387 1.514-.263 2.868.356 3.061 1.403Z"></path></svg></a></div></div></div></div></div></header><div id="__blog-post-container" class="markdown"><p>HTSlib-based tools like <code>bcftools</code> and <code>samtools</code> provide powerful capabilities for working with genomic data stored on remote servers. Whether your data is in AWS S3, accessible via FTP, or hosted on HTTPS endpoints, these tools allow you to efficiently query and subset remote files without downloading entire datasets. This guide covers authentication, remote file access patterns, and practical workflows.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="1-how-htslib-handles-remote-files-with-random-access">1. How HTSlib Handles Remote Files with Random Access<a href="#1-how-htslib-handles-remote-files-with-random-access" class="hash-link" aria-label="Direct link to 1. How HTSlib Handles Remote Files with Random Access" title="Direct link to 1. How HTSlib Handles Remote Files with Random Access" translate="no">​</a></h2>
<p>HTSlib is a C library that powers many genomic tools. Tools built on HTSlib—including <code>bcftools</code>, <code>samtools</code>, <code>tabix</code>, and others—inherit native support for <strong>remote file access via random access queries</strong>. This section explains how HTSlib works with remote files and which protocols are supported.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="11-random-access-mechanism-the-foundation">1.1 Random Access Mechanism: The Foundation<a href="#11-random-access-mechanism-the-foundation" class="hash-link" aria-label="Direct link to 1.1 Random Access Mechanism: The Foundation" title="Direct link to 1.1 Random Access Mechanism: The Foundation" translate="no">​</a></h3>
<p>HTSlib enables efficient remote file access through a <strong>byte-range request mechanism</strong>. Instead of downloading entire files, it uses file indexes to determine exact byte positions and requests only those bytes from the remote server.</p>
<p><strong>How it works:</strong></p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">User Request:</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  bcftools view s3://bucket/variants.vcf.gz chr1:1000-2000</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">HTSlib Process:</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">1. Reads index file (.vcf.gz.tbi) to find byte ranges</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">2. Index lookup: &quot;chr1:1000-2000 is at bytes 5000-15000&quot;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">3. Sends byte-range request to remote server</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">4. Remote server returns ONLY requested bytes (10KB, not 1GB!)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">5. HTSlib decompresses partial data</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">6. Returns matching variants to user</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">Result: 10KB downloaded instead of 1GB</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">Time: 1-5 seconds instead of 5-30 minutes</span><br></span></code></pre></div></div>
<p><strong>Critical requirement: Indexed files</strong> (<code>.tbi</code>, <code>.bai</code>, <code>.csi</code>)</p>
<ul>
<li class="">Without index: Must download entire file from start (fails on large files)</li>
<li class="">With index: Downloads only necessary bytes (efficient and fast)</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="12-all-supported-url-schemes">1.2 All Supported URL Schemes<a href="#12-all-supported-url-schemes" class="hash-link" aria-label="Direct link to 1.2 All Supported URL Schemes" title="Direct link to 1.2 All Supported URL Schemes" translate="no">​</a></h3>
<p>HTSlib supports a comprehensive list of protocols via <code>libcurl</code>. Check your installation:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)"># View all supported protocols</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">pixi run samtools </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">--version</span><span class="token plain"> </span><span class="token operator file-descriptor important" style="color:hsl(230, 8%, 24%);font-weight:bold">2</span><span class="token operator" style="color:hsl(221, 87%, 60%)">&gt;</span><span class="token file-descriptor important" style="color:hsl(230, 8%, 24%);font-weight:bold">&amp;1</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">|</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-A</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">20</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">&quot;HTSlib URL&quot;</span><br></span></code></pre></div></div>
<p><strong>Complete output example:</strong></p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">HTSlib URL scheme handlers present:</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    built-in:        file, preload, data</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    Google Cloud:    gs+http, gs+https, gs</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    libcurl:         gophers, smtp, wss, smb, rtsp, tftp, pop3, smbs, imaps, pop3s, ws, ftps, ftp, gopher, imap, http, https, sftp, smtps, scp, dict, mqtt, telnet</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    Amazon S3:       s3+https, s3, s3+http</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    crypt4gh:        crypt4gh</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    mem:             mem</span><br></span></code></pre></div></div>
<p><strong>Protocol categories:</strong></p>
<table><thead><tr><th>Category</th><th>Protocols</th><th>Typical Use</th></tr></thead><tbody><tr><td><strong>Built-in</strong></td><td>file, preload, data</td><td>Local files, pipes</td></tr><tr><td><strong>Cloud Storage</strong></td><td>s3://, gs://</td><td>AWS, Google Cloud</td></tr><tr><td><strong>HTTP-based</strong></td><td>http://, https://, ftps://</td><td>Web servers, FTP over SSL</td></tr><tr><td><strong>Other</strong></td><td>ftp://, sftp://, scp://, smb://</td><td>Traditional file servers</td></tr><tr><td><strong>Specialized</strong></td><td>mqtt, dict, imap, etc</td><td>Not typical for genomics</td></tr></tbody></table>
<p><strong>Note on protocol coverage:</strong> This blog focuses on the most common protocols for bioinformatics: <strong>S3, HTTPS, FTP, and GCS</strong>. Many other protocols are available but less commonly used for genomic data.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="13-typical-bioinformatics-protocols-covered-in-this-blog">1.3 Typical Bioinformatics Protocols (Covered in This Blog)<a href="#13-typical-bioinformatics-protocols-covered-in-this-blog" class="hash-link" aria-label="Direct link to 1.3 Typical Bioinformatics Protocols (Covered in This Blog)" title="Direct link to 1.3 Typical Bioinformatics Protocols (Covered in This Blog)" translate="no">​</a></h3>
<p>The following protocols are widely used for storing and accessing genomic data:</p>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="s3-amazon-s3-and-compatible">S3 (Amazon S3 and compatible)<a href="#s3-amazon-s3-and-compatible" class="hash-link" aria-label="Direct link to S3 (Amazon S3 and compatible)" title="Direct link to S3 (Amazon S3 and compatible)" translate="no">​</a></h4>
<ul>
<li class=""><strong>URL scheme</strong>: <code>s3://bucket-name/path/file.vcf.gz</code></li>
<li class=""><strong>Use case</strong>: Cloud-based genomic repositories, AWS-hosted data</li>
<li class=""><strong>Random access</strong>: Via byte-range requests, AWS SDK for auth</li>
<li class=""><strong>Speed</strong>: Fastest (typically &lt;1 second for indexed queries)</li>
<li class=""><strong>See section</strong>: 2 - S3 Remote File Access</li>
</ul>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="https-web-servers">HTTPS (Web servers)<a href="#https-web-servers" class="hash-link" aria-label="Direct link to HTTPS (Web servers)" title="Direct link to HTTPS (Web servers)" translate="no">​</a></h4>
<ul>
<li class=""><strong>URL scheme</strong>: <code>https://server.com/path/file.vcf.gz</code></li>
<li class=""><strong>Use case</strong>: Public databases (NCBI, Ensembl), institutional servers</li>
<li class=""><strong>Random access</strong>: Via HTTP Range header (206 Partial Content)</li>
<li class=""><strong>Speed</strong>: Fast (1-2 seconds for indexed queries)</li>
<li class=""><strong>See section</strong>: 4 - HTTPS Remote File Access</li>
</ul>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="ftp-file-transfer-protocol">FTP (File Transfer Protocol)<a href="#ftp-file-transfer-protocol" class="hash-link" aria-label="Direct link to FTP (File Transfer Protocol)" title="Direct link to FTP (File Transfer Protocol)" translate="no">​</a></h4>
<ul>
<li class=""><strong>URL scheme</strong>: <code>ftp://server.com/path/file.vcf.gz</code></li>
<li class=""><strong>Use case</strong>: Legacy databases, some public repositories</li>
<li class=""><strong>Random access</strong>: Via FTP REST command for seeking</li>
<li class=""><strong>Speed</strong>: Slower (3-5 seconds for indexed queries)</li>
<li class=""><strong>See section</strong>: 3 - FTP Remote File Access</li>
</ul>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="gcs-google-cloud-storage">GCS (Google Cloud Storage)<a href="#gcs-google-cloud-storage" class="hash-link" aria-label="Direct link to GCS (Google Cloud Storage)" title="Direct link to GCS (Google Cloud Storage)" translate="no">​</a></h4>
<ul>
<li class=""><strong>URL scheme</strong>: <code>gs://bucket-name/path/file.vcf.gz</code></li>
<li class=""><strong>Use case</strong>: Google Cloud-hosted genomic data</li>
<li class=""><strong>Random access</strong>: Similar to S3 (byte-range requests)</li>
<li class=""><strong>Speed</strong>: Fast (typically &lt;1 second for indexed queries)</li>
<li class=""><strong>Note</strong>: Requires Google Cloud SDK credentials</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="14-key-advantages-of-remote-access">1.4 Key Advantages of Remote Access<a href="#14-key-advantages-of-remote-access" class="hash-link" aria-label="Direct link to 1.4 Key Advantages of Remote Access" title="Direct link to 1.4 Key Advantages of Remote Access" translate="no">​</a></h3>
<ul>
<li class=""><strong>Avoid large downloads</strong>: Query specific regions without transferring entire files</li>
<li class=""><strong>Cost efficiency</strong>: Pay only for data you access, not storage</li>
<li class=""><strong>Scalability</strong>: Work with datasets larger than local disk space</li>
<li class=""><strong>Collaboration</strong>: Reference shared datasets directly without copying</li>
<li class=""><strong>Real-time access</strong>: Always work with latest version of data</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="15-performance-considerations-why-indexes-matter">1.5 Performance Considerations: Why Indexes Matter<a href="#15-performance-considerations-why-indexes-matter" class="hash-link" aria-label="Direct link to 1.5 Performance Considerations: Why Indexes Matter" title="Direct link to 1.5 Performance Considerations: Why Indexes Matter" translate="no">​</a></h3>
<p>Remote file access requires indexed files for efficient region-based queries:</p>
<ul>
<li class=""><strong>VCF files</strong>: Must have <code>.vcf.gz.tbi</code> index</li>
<li class=""><strong>BAM files</strong>: Must have <code>.bam.bai</code> index</li>
<li class=""><strong>BCF files</strong>: Must have <code>.bcf.csi</code> index</li>
</ul>
<p><strong>Bandwidth comparison for 1GB VCF file querying chr1:1-100000:</strong></p>
<table><thead><tr><th>Scenario</th><th>Bytes Transferred</th><th>Time</th><th>Method</th></tr></thead><tbody><tr><td><strong>Indexed S3</strong></td><td>~700KB</td><td>&lt;1 second</td><td>Byte-range request</td></tr><tr><td><strong>Indexed HTTPS</strong></td><td>~700KB</td><td>1-2 seconds</td><td>HTTP Range header</td></tr><tr><td><strong>Indexed FTP</strong></td><td>~700KB</td><td>3-5 seconds</td><td>FTP REST seek</td></tr><tr><td><strong>Unindexed remote</strong></td><td>1000MB+</td><td>5-30 minutes</td><td>Sequential download</td></tr><tr><td><strong>Local indexed file</strong></td><td>~700KB</td><td>&lt;0.5 seconds</td><td>Direct file seek</td></tr></tbody></table>
<p><strong>Critical insight</strong>: Indexed remote access downloads only 0.07% of file size!</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="16-setting-up-bcftools-and-samtools-with-pixi">1.6 Setting Up bcftools and samtools with Pixi<a href="#16-setting-up-bcftools-and-samtools-with-pixi" class="hash-link" aria-label="Direct link to 1.6 Setting Up bcftools and samtools with Pixi" title="Direct link to 1.6 Setting Up bcftools and samtools with Pixi" translate="no">​</a></h3>
<p>The easiest way to install bcftools and samtools with full remote file support is using Pixi with the <code>conda-forge</code> and <code>bioconda</code> channels. These channels include pre-compiled binaries with S3, FTP, and HTTPS support enabled in HTSlib.</p>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="installation-steps">Installation Steps<a href="#installation-steps" class="hash-link" aria-label="Direct link to Installation Steps" title="Direct link to Installation Steps" translate="no">​</a></h4>
<p>Create a new directory for your project and initialize a Pixi environment:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)"># Create project directory</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token function" style="color:hsl(221, 87%, 60%)">mkdir</span><span class="token plain"> </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-p</span><span class="token plain"> ~/htslib-project </span><span class="token operator" style="color:hsl(221, 87%, 60%)">&amp;&amp;</span><span class="token plain"> </span><span class="token builtin class-name" style="color:hsl(35, 99%, 36%)">cd</span><span class="token plain"> ~/htslib-project</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)"># Initialize Pixi with conda-forge and bioconda channels</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">pixi init </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">--channel</span><span class="token plain"> conda-forge </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">--channel</span><span class="token plain"> bioconda </span><span class="token builtin class-name" style="color:hsl(35, 99%, 36%)">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)"># Add bcftools and samtools</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">pixi </span><span class="token function" style="color:hsl(221, 87%, 60%)">add</span><span class="token plain"> bcftools samtools</span><br></span></code></pre></div></div>
<p>This creates a <code>pixi.toml</code> file:</p>
<div class="language-toml codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-toml codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">[workspace]</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">channels = [&quot;conda-forge&quot;, &quot;bioconda&quot;]</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">name = &quot;htslib-project&quot;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">platforms = [&quot;linux-64&quot;]</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">version = &quot;0.1.0&quot;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">[dependencies]</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">bcftools = &quot;&gt;=1.23,&lt;2&quot;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">samtools = &quot;&gt;=1.23,&lt;2&quot;</span><br></span></code></pre></div></div>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="verify-installation">Verify Installation<a href="#verify-installation" class="hash-link" aria-label="Direct link to Verify Installation" title="Direct link to Verify Installation" translate="no">​</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)"># Run bcftools version</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">pixi run bcftools </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">--version</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)"># Run samtools version</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">pixi run samtools </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">--version</span><br></span></code></pre></div></div>
<p>Both tools will report HTSlib features including S3, GCS, and libcurl support:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">bcftools 1.23</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">Using htslib 1.23</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">...</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">Samtools 1.23</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">...</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">HTSlib compilation details:</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    Features:       build=configure libcurl=yes S3=yes GCS=yes ...</span><br></span></code></pre></div></div>
<p>The key line is <code>S3=yes</code> indicating S3 support is enabled.</p>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="why-pixi-for-remote-file-access">Why Pixi for Remote File Access?<a href="#why-pixi-for-remote-file-access" class="hash-link" aria-label="Direct link to Why Pixi for Remote File Access?" title="Direct link to Why Pixi for Remote File Access?" translate="no">​</a></h4>
<ul>
<li class=""><strong>Pre-compiled with remote support</strong>: Bioconda packages include HTSlib compiled with libcurl, S3, and GCS support</li>
<li class=""><strong>Easy dependency management</strong>: All required libraries included automatically</li>
<li class=""><strong>Reproducible environments</strong>: <code>pixi.lock</code> ensures the same versions across machines</li>
<li class=""><strong>No system-wide installation</strong>: Keep tools isolated in your project environment</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="17-protocol-verification-http-range-requests">1.7 Protocol Verification: HTTP Range Requests<a href="#17-protocol-verification-http-range-requests" class="hash-link" aria-label="Direct link to 1.7 Protocol Verification: HTTP Range Requests" title="Direct link to 1.7 Protocol Verification: HTTP Range Requests" translate="no">​</a></h3>
<p>For HTTPS/HTTP remote access to work efficiently, the server must support HTTP Range Requests. Verify this before relying on remote queries:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)"># Test if server supports Range Requests</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token function" style="color:hsl(221, 87%, 60%)">curl</span><span class="token plain"> </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-I</span><span class="token plain"> </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-H</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">&quot;Range: bytes=0-500&quot;</span><span class="token plain"> https://ftp.ncbi.nlm.nih.gov/snp/organisms/human_9606_b150_GRCh37p13/VCF/00-common_all_papu.vcf.gz</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)"># Expected response: HTTP/1.1 206 Partial Content</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)"># This means byte-range requests work! ✓</span><br></span></code></pre></div></div>
<p>Response headers will show:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">HTTP/1.1 206 Partial Content      ← supports Range requests</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">Accept-Ranges: bytes              ← confirms support</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">Content-Length: 501               ← returns partial content</span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="2-s3-remote-file-access">2. S3 Remote File Access<a href="#2-s3-remote-file-access" class="hash-link" aria-label="Direct link to 2. S3 Remote File Access" title="Direct link to 2. S3 Remote File Access" translate="no">​</a></h2>
<p>AWS S3 is a common repository for genomic datasets. HTSlib supports S3 through the <code>s3://</code> protocol.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="21-s3-authentication">2.1 S3 Authentication<a href="#21-s3-authentication" class="hash-link" aria-label="Direct link to 2.1 S3 Authentication" title="Direct link to 2.1 S3 Authentication" translate="no">​</a></h3>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="using-aws-credentials">Using AWS Credentials<a href="#using-aws-credentials" class="hash-link" aria-label="Direct link to Using AWS Credentials" title="Direct link to Using AWS Credentials" translate="no">​</a></h4>
<p>Set AWS credentials as environment variables:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token builtin class-name" style="color:hsl(35, 99%, 36%)">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:hsl(221, 87%, 60%)">AWS_ACCESS_KEY_ID</span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token string" style="color:hsl(119, 34%, 47%)">&quot;your_access_key&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token builtin class-name" style="color:hsl(35, 99%, 36%)">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:hsl(221, 87%, 60%)">AWS_SECRET_ACCESS_KEY</span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token string" style="color:hsl(119, 34%, 47%)">&quot;your_secret_key&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token builtin class-name" style="color:hsl(35, 99%, 36%)">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:hsl(221, 87%, 60%)">AWS_DEFAULT_REGION</span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token string" style="color:hsl(119, 34%, 47%)">&quot;us-east-1&quot;</span><br></span></code></pre></div></div>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="using-aws-iam-roles-ec2-instances">Using AWS IAM Roles (EC2 Instances)<a href="#using-aws-iam-roles-ec2-instances" class="hash-link" aria-label="Direct link to Using AWS IAM Roles (EC2 Instances)" title="Direct link to Using AWS IAM Roles (EC2 Instances)" translate="no">​</a></h4>
<p>If running on EC2 with an IAM role attached, HTSlib automatically uses the role&#x27;s credentials—no environment variables needed.</p>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="using-aws-cli-configuration">Using AWS CLI Configuration<a href="#using-aws-cli-configuration" class="hash-link" aria-label="Direct link to Using AWS CLI Configuration" title="Direct link to Using AWS CLI Configuration" translate="no">​</a></h4>
<p>HTSlib respects <code>~/.aws/credentials</code> and <code>~/.aws/config</code>:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">aws configure  </span><span class="token comment" style="color:hsl(230, 4%, 64%)"># Interactive setup</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="22-querying-s3-hosted-vcf-files">2.2 Querying S3-hosted VCF Files<a href="#22-querying-s3-hosted-vcf-files" class="hash-link" aria-label="Direct link to 2.2 Querying S3-hosted VCF Files" title="Direct link to 2.2 Querying S3-hosted VCF Files" translate="no">​</a></h3>
<p>Query a specific genomic region from a remote VCF file:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)"># Query chromosome 1, positions 1-1000000</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">bcftools view s3://my-bucket/data/variants.vcf.gz chr1:1-1000000</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)"># Count variants in a region</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">bcftools view </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-H</span><span class="token plain"> s3://my-bucket/data/variants.vcf.gz chr1:1-1000000 </span><span class="token operator" style="color:hsl(221, 87%, 60%)">|</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">wc</span><span class="token plain"> </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-l</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)"># Extract samples and subset to region</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">bcftools view </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-s</span><span class="token plain"> sample1,sample2 s3://my-bucket/data/variants.vcf.gz chr1:1-1000000 </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-O</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">v</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="23-querying-s3-hosted-bam-files">2.3 Querying S3-hosted BAM Files<a href="#23-querying-s3-hosted-bam-files" class="hash-link" aria-label="Direct link to 2.3 Querying S3-hosted BAM Files" title="Direct link to 2.3 Querying S3-hosted BAM Files" translate="no">​</a></h3>
<p>Extract reads from specific genomic regions:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)"># Query region from remote BAM</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">samtools view s3://my-bucket/data/aligned.bam chr1:1-1000000</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)"># Count reads in region</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">samtools view </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-c</span><span class="token plain"> s3://my-bucket/data/aligned.bam chr1:1-1000000</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)"># Extract to local BAM file</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">samtools view </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-b</span><span class="token plain"> s3://my-bucket/data/aligned.bam chr1:1-1000000 </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-o</span><span class="token plain"> region.bam</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="24-region-based-subsetting-workflow">2.4 Region-based Subsetting Workflow<a href="#24-region-based-subsetting-workflow" class="hash-link" aria-label="Direct link to 2.4 Region-based Subsetting Workflow" title="Direct link to 2.4 Region-based Subsetting Workflow" translate="no">​</a></h3>
<p>Efficient workflow for extracting subsets from S3:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)"># 1. List available S3 files (using AWS CLI)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">aws s3 </span><span class="token function" style="color:hsl(221, 87%, 60%)">ls</span><span class="token plain"> s3://my-bucket/data/ </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">--recursive</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)"># 2. Query specific region from VCF</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">bcftools view </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  s3://my-bucket/data/chr1.vcf.gz </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  chr1:10000000-20000000 </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-O</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">v</span><span class="token plain"> </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-o</span><span class="token plain"> local_subset.vcf</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)"># 3. Validate and compress</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">bgzip </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-f</span><span class="token plain"> local_subset.vcf</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">tabix </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-p</span><span class="token plain"> vcf local_subset.vcf.gz</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)"># 4. Annotate or further process locally</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">bcftools annotate local_subset.vcf.gz </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-a</span><span class="token plain"> annotation.vcf.gz </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-c</span><span class="token plain"> ID</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="25-working-with-public-genomic-data">2.5 Working with Public Genomic Data<a href="#25-working-with-public-genomic-data" class="hash-link" aria-label="Direct link to 2.5 Working with Public Genomic Data" title="Direct link to 2.5 Working with Public Genomic Data" translate="no">​</a></h3>
<p>Public genomic repositories are excellent for testing remote file access. While S3 is available, HTTPS endpoints are often more reliable for quick testing.</p>
<p><strong>Query NCBI dbSNP data via HTTPS:</strong></p>
<p>NCBI provides public access to common variants. Test with real data:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)"># Query NCBI dbSNP common variants (via HTTPS)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">pixi run bcftools view </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  https://ftp.ncbi.nlm.nih.gov/snp/organisms/human_9606_b150_GRCh37p13/VCF/00-common_all.vcf.gz </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token operator" style="color:hsl(221, 87%, 60%)">|</span><span class="token plain"> pixi run bcftools query </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-f</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">&#x27;%CHROM\t%POS\t%REF\t%ALT\n&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token operator" style="color:hsl(221, 87%, 60%)">|</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">head</span><span class="token plain"> </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-20</span><br></span></code></pre></div></div>
<p>Expected output showing real variants:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">1	10177	A	AC</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">1	10352	T	TA</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">1	10352	T	TA</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">1	10616	CCGCCGTTGCAAAGGCGCGCCG	C</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">1	10642	G	A</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">1	11008	C	G</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">1	11012	C	G</span><br></span></code></pre></div></div>
<p><strong>Discover available files:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)"># List NCBI FTP VCF files</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token function" style="color:hsl(221, 87%, 60%)">curl</span><span class="token plain"> </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-s</span><span class="token plain"> https://ftp.ncbi.nlm.nih.gov/snp/organisms/human_9606_b150_GRCh37p13/VCF/ </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token operator" style="color:hsl(221, 87%, 60%)">|</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-i</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">&quot;.vcf.gz</span><span class="token string entity" style="color:hsl(230, 8%, 24%)">\&quot;</span><span class="token string" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">|</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-o</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">&quot;href=</span><span class="token string entity" style="color:hsl(230, 8%, 24%)">\&quot;</span><span class="token string" style="color:hsl(119, 34%, 47%)">[^</span><span class="token string entity" style="color:hsl(230, 8%, 24%)">\&quot;</span><span class="token string" style="color:hsl(119, 34%, 47%)">]*</span><span class="token string entity" style="color:hsl(230, 8%, 24%)">\&quot;</span><span class="token string" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">|</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">cut</span><span class="token plain"> -d</span><span class="token string" style="color:hsl(119, 34%, 47%)">&#x27;&quot;&#x27;</span><span class="token plain"> </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-f2</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)"># Or for 1000 Genomes in S3:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">aws s3 </span><span class="token function" style="color:hsl(221, 87%, 60%)">ls</span><span class="token plain"> s3://1000genomes/phase3/data/ --no-sign-request </span><span class="token operator" style="color:hsl(221, 87%, 60%)">|</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">head</span><span class="token plain"> </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-20</span><br></span></code></pre></div></div>
<p><strong>Region-based queries (with indexed files):</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)"># Query specific chromosome region</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)"># Note: Requires .tbi index at the remote location</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">pixi run bcftools view </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  https://ftp.ncbi.nlm.nih.gov/snp/organisms/human_9606_b150_GRCh37p13/VCF/00-common_all.vcf.gz </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  chr1:1000000-2000000</span><br></span></code></pre></div></div>
<p><strong>Note on S3 vs HTTPS:</strong></p>
<ul>
<li class=""><strong>HTTPS</strong> (like NCBI): Reliable, requires no credentials for public data</li>
<li class=""><strong>S3</strong>: Fastest for large datasets, requires AWS credentials or public bucket setup</li>
<li class=""><strong>FTP</strong>: Alternative for some repositories, generally slower than HTTPS</li>
</ul>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="3-ftp-remote-file-access">3. FTP Remote File Access<a href="#3-ftp-remote-file-access" class="hash-link" aria-label="Direct link to 3. FTP Remote File Access" title="Direct link to 3. FTP Remote File Access" translate="no">​</a></h2>
<p>FTP servers host many public genomic datasets. HTSlib supports the <code>ftp://</code> protocol.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="31-ftp-authentication">3.1 FTP Authentication<a href="#31-ftp-authentication" class="hash-link" aria-label="Direct link to 3.1 FTP Authentication" title="Direct link to 3.1 FTP Authentication" translate="no">​</a></h3>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="anonymous-access">Anonymous Access<a href="#anonymous-access" class="hash-link" aria-label="Direct link to Anonymous Access" title="Direct link to Anonymous Access" translate="no">​</a></h4>
<p>Many public repositories allow anonymous FTP:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)"># No credentials needed</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">bcftools view ftp://ftp.ncbi.nlm.nih.gov/genomes/H_sapiens/VCF/common_all.vcf.gz chr1:1-1000000</span><br></span></code></pre></div></div>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="authenticated-ftp">Authenticated FTP<a href="#authenticated-ftp" class="hash-link" aria-label="Direct link to Authenticated FTP" title="Direct link to Authenticated FTP" translate="no">​</a></h4>
<p>For private FTP servers, include credentials in the URL:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">bcftools view ftp://username:password@ftp.example.com/data/variants.vcf.gz chr1:1-1000000</span><br></span></code></pre></div></div>
<p><strong>Security Note</strong>: URL-embedded credentials are visible in process listings. Prefer environment variables:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token builtin class-name" style="color:hsl(35, 99%, 36%)">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:hsl(221, 87%, 60%)">FTP_USER</span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token string" style="color:hsl(119, 34%, 47%)">&quot;your_username&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token builtin class-name" style="color:hsl(35, 99%, 36%)">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:hsl(221, 87%, 60%)">FTP_PASSWORD</span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token string" style="color:hsl(119, 34%, 47%)">&quot;your_password&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)"># HTSlib will use these automatically</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">bcftools view ftp://ftp.example.com/data/variants.vcf.gz chr1:1-1000000</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="32-querying-ftp-hosted-files">3.2 Querying FTP-hosted Files<a href="#32-querying-ftp-hosted-files" class="hash-link" aria-label="Direct link to 3.2 Querying FTP-hosted Files" title="Direct link to 3.2 Querying FTP-hosted Files" translate="no">​</a></h3>
<p>Common public genomic repositories accessible via FTP:</p>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="ncbi-ftp-repository">NCBI FTP Repository<a href="#ncbi-ftp-repository" class="hash-link" aria-label="Direct link to NCBI FTP Repository" title="Direct link to NCBI FTP Repository" translate="no">​</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)"># Query NCBI&#x27;s common variants file</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">bcftools view </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  ftp://ftp.ncbi.nlm.nih.gov/snp/organisms/human_9606_b150_GRCh37p13/VCF/common_all.vcf.gz </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  chr1:1-1000000 </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token operator" style="color:hsl(221, 87%, 60%)">|</span><span class="token plain"> bcftools query </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-f</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">&#x27;%CHROM\t%POS\t%AC\t%AF\n&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token operator" style="color:hsl(221, 87%, 60%)">|</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">head</span><span class="token plain"> </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-10</span><br></span></code></pre></div></div>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="ensembl-ftp-repository">Ensembl FTP Repository<a href="#ensembl-ftp-repository" class="hash-link" aria-label="Direct link to Ensembl FTP Repository" title="Direct link to Ensembl FTP Repository" translate="no">​</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)"># Query Ensembl VCF (example path)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">bcftools view </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  ftp://ftp.ensembl.org/pub/data_files/homo_sapiens/VEP/Homo_sapiens_phenotypes_associated_variants-GRCh38.vcf.gz </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token number" style="color:hsl(35, 99%, 36%)">1</span><span class="token plain">:1-1000000</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)"># List available Ensembl files</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token function" style="color:hsl(221, 87%, 60%)">ftp</span><span class="token plain"> ftp.ensembl.org  </span><span class="token comment" style="color:hsl(230, 4%, 64%)"># Interactive FTP session</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="33-ftp-performance-tips">3.3 FTP Performance Tips<a href="#33-ftp-performance-tips" class="hash-link" aria-label="Direct link to 3.3 FTP Performance Tips" title="Direct link to 3.3 FTP Performance Tips" translate="no">​</a></h3>
<ul>
<li class=""><strong>Network stability</strong>: FTP can be slower than HTTPS for single queries. Consider batch processing.</li>
<li class=""><strong>Index availability</strong>: Verify <code>.tbi</code> or <code>.csi</code> indexes are present on the FTP server for efficient region queries.</li>
<li class=""><strong>Timeout handling</strong>: Set timeout environment variables for unreliable connections:</li>
</ul>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token builtin class-name" style="color:hsl(35, 99%, 36%)">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:hsl(221, 87%, 60%)">CURL_CONNECT_TIMEOUT</span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token number" style="color:hsl(35, 99%, 36%)">30</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token builtin class-name" style="color:hsl(35, 99%, 36%)">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:hsl(221, 87%, 60%)">CURL_TIMEOUT</span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token number" style="color:hsl(35, 99%, 36%)">60</span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="4-https-remote-file-access">4. HTTPS Remote File Access<a href="#4-https-remote-file-access" class="hash-link" aria-label="Direct link to 4. HTTPS Remote File Access" title="Direct link to 4. HTTPS Remote File Access" translate="no">​</a></h2>
<p>HTTPS endpoints often require token-based authentication and are increasingly common for cloud-hosted data.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="41-https-authentication-methods">4.1 HTTPS Authentication Methods<a href="#41-https-authentication-methods" class="hash-link" aria-label="Direct link to 4.1 HTTPS Authentication Methods" title="Direct link to 4.1 HTTPS Authentication Methods" translate="no">​</a></h3>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="bearer-token-authentication">Bearer Token Authentication<a href="#bearer-token-authentication" class="hash-link" aria-label="Direct link to Bearer Token Authentication" title="Direct link to Bearer Token Authentication" translate="no">​</a></h4>
<p>For endpoints that accept Bearer tokens (common in cloud platforms):</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)"># Option 1: Set environment variable</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token builtin class-name" style="color:hsl(35, 99%, 36%)">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:hsl(221, 87%, 60%)">HTTPS_AUTH_BEARER</span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token string" style="color:hsl(119, 34%, 47%)">&quot;your_bearer_token&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">bcftools view https://api.example.com/data/variants.vcf.gz chr1:1-1000000</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)"># Option 2: Pass in URL (less secure)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">bcftools view https://token:your_bearer_token@api.example.com/data/variants.vcf.gz chr1:1-1000000</span><br></span></code></pre></div></div>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="api-keys-in-headers">API Keys in Headers<a href="#api-keys-in-headers" class="hash-link" aria-label="Direct link to API Keys in Headers" title="Direct link to API Keys in Headers" translate="no">​</a></h4>
<p>For services requiring custom headers, use <code>curl</code> with a named pipe:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)"># Create a wrapper using curl and process substitution</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">bcftools view </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token operator" style="color:hsl(221, 87%, 60%)">&lt;</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token function" style="color:hsl(221, 87%, 60%)">curl</span><span class="token plain"> </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-H</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">&quot;Authorization: Bearer TOKEN&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     https://api.example.com/data/variants.vcf.gz </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">     </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">--output</span><span class="token plain"> - </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  chr1:1-1000000</span><br></span></code></pre></div></div>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="basic-http-authentication">Basic HTTP Authentication<a href="#basic-http-authentication" class="hash-link" aria-label="Direct link to Basic HTTP Authentication" title="Direct link to Basic HTTP Authentication" translate="no">​</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)"># URL-embedded credentials (not recommended for security)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">bcftools view https://username:password@secure.example.com/data/variants.vcf.gz chr1:1-1000000</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="42-practical-https-workflows">4.2 Practical HTTPS Workflows<a href="#42-practical-https-workflows" class="hash-link" aria-label="Direct link to 4.2 Practical HTTPS Workflows" title="Direct link to 4.2 Practical HTTPS Workflows" translate="no">​</a></h3>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="query-public-https-hosted-data">Query Public HTTPS-hosted Data<a href="#query-public-https-hosted-data" class="hash-link" aria-label="Direct link to Query Public HTTPS-hosted Data" title="Direct link to Query Public HTTPS-hosted Data" translate="no">​</a></h4>
<p>Many databases provide HTTPS access to genomic data:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)"># Example: Query genome annotation from HTTPS endpoint</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">bcftools view https://example.genomics.org/public/variants.vcf.gz chr1:1-1000000</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)"># Extract specific information</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">bcftools view https://example.genomics.org/public/variants.vcf.gz chr1:1-1000000 </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token operator" style="color:hsl(221, 87%, 60%)">|</span><span class="token plain"> bcftools query </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-f</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">&#x27;%CHROM\t%POS\t%REF\t%ALT\t%AC\n&#x27;</span><br></span></code></pre></div></div>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="download-indexed-files-locally">Download Indexed Files Locally<a href="#download-indexed-files-locally" class="hash-link" aria-label="Direct link to Download Indexed Files Locally" title="Direct link to Download Indexed Files Locally" translate="no">​</a></h4>
<p>For repeated queries, consider caching indexes locally:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)"># Download index file (small, fast)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token function" style="color:hsl(221, 87%, 60%)">curl</span><span class="token plain"> </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-o</span><span class="token plain"> variants.vcf.gz.tbi https://api.example.com/data/variants.vcf.gz.tbi</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)"># Query still uses remote file but with local index knowledge</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">bcftools view https://api.example.com/data/variants.vcf.gz chr1:1-1000000</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="43-ssltls-certificate-issues">4.3 SSL/TLS Certificate Issues<a href="#43-ssltls-certificate-issues" class="hash-link" aria-label="Direct link to 4.3 SSL/TLS Certificate Issues" title="Direct link to 4.3 SSL/TLS Certificate Issues" translate="no">​</a></h3>
<p>If you encounter certificate validation errors:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)"># Disable certificate verification (use cautiously)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token builtin class-name" style="color:hsl(35, 99%, 36%)">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:hsl(221, 87%, 60%)">SSL_NO_VERIFY</span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token number" style="color:hsl(35, 99%, 36%)">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">bcftools view https://api.example.com/data/variants.vcf.gz chr1:1-1000000</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)"># Or use curl environment variable</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token builtin class-name" style="color:hsl(35, 99%, 36%)">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:hsl(221, 87%, 60%)">CURL_CA_BUNDLE</span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token string" style="color:hsl(119, 34%, 47%)">&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">bcftools view https://api.example.com/data/variants.vcf.gz chr1:1-1000000</span><br></span></code></pre></div></div>
<p><strong>Security Note</strong>: Only disable certificate verification for trusted internal endpoints or testing.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="5-indexing-and-efficient-region-queries">5. Indexing and Efficient Region Queries<a href="#5-indexing-and-efficient-region-queries" class="hash-link" aria-label="Direct link to 5. Indexing and Efficient Region Queries" title="Direct link to 5. Indexing and Efficient Region Queries" translate="no">​</a></h2>
<p>Efficient remote file access depends on proper indexing. HTSlib tools use byte-range requests to fetch only necessary data.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="51-creating-indexes">5.1 Creating Indexes<a href="#51-creating-indexes" class="hash-link" aria-label="Direct link to 5.1 Creating Indexes" title="Direct link to 5.1 Creating Indexes" translate="no">​</a></h3>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="create-tabix-index-for-vcf-files">Create Tabix Index for VCF Files<a href="#create-tabix-index-for-vcf-files" class="hash-link" aria-label="Direct link to Create Tabix Index for VCF Files" title="Direct link to Create Tabix Index for VCF Files" translate="no">​</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)"># For bgzip-compressed VCF files</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">tabix </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-p</span><span class="token plain"> vcf variants.vcf.gz</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)"># Verify index</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token function" style="color:hsl(221, 87%, 60%)">ls</span><span class="token plain"> </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-lh</span><span class="token plain"> variants.vcf.gz*</span><br></span></code></pre></div></div>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="create-csi-index-for-bcf-files">Create CSI Index for BCF Files<a href="#create-csi-index-for-bcf-files" class="hash-link" aria-label="Direct link to Create CSI Index for BCF Files" title="Direct link to Create CSI Index for BCF Files" translate="no">​</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)"># CSI indexes support larger files and datasets</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">bcftools index </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-c</span><span class="token plain"> variants.bcf</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)"># Verify index</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token function" style="color:hsl(221, 87%, 60%)">ls</span><span class="token plain"> </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-lh</span><span class="token plain"> variants.bcf.csi</span><br></span></code></pre></div></div>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="create-bai-index-for-bam-files">Create BAI Index for BAM Files<a href="#create-bai-index-for-bam-files" class="hash-link" aria-label="Direct link to Create BAI Index for BAM Files" title="Direct link to Create BAI Index for BAM Files" translate="no">​</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)"># Standard BAM indexing</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">samtools index aligned.bam</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)"># Creates aligned.bam.bai</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token function" style="color:hsl(221, 87%, 60%)">ls</span><span class="token plain"> </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-lh</span><span class="token plain"> aligned.bam.bai</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="52-verifying-index-integrity">5.2 Verifying Index Integrity<a href="#52-verifying-index-integrity" class="hash-link" aria-label="Direct link to 5.2 Verifying Index Integrity" title="Direct link to 5.2 Verifying Index Integrity" translate="no">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)"># Check if VCF index is valid</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">tabix </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-l</span><span class="token plain"> variants.vcf.gz </span><span class="token operator" style="color:hsl(221, 87%, 60%)">|</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">head</span><span class="token plain"> </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-10</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)"># Query a specific region (tests index)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">bcftools view variants.vcf.gz chr1:1-1000 </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-H</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">|</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">wc</span><span class="token plain"> </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-l</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="53-performance-indexed-vs-unindexed-remote-access">5.3 Performance: Indexed vs Unindexed Remote Access<a href="#53-performance-indexed-vs-unindexed-remote-access" class="hash-link" aria-label="Direct link to 5.3 Performance: Indexed vs Unindexed Remote Access" title="Direct link to 5.3 Performance: Indexed vs Unindexed Remote Access" translate="no">​</a></h3>
<p><strong>Indexed remote access</strong> (with region query):</p>
<ul>
<li class="">Seeks to file index</li>
<li class="">Downloads byte-range containing target region</li>
<li class="">Returns ~100KB-1MB of data</li>
</ul>
<p><strong>Unindexed remote access</strong>:</p>
<ul>
<li class="">Must scan entire file sequentially</li>
<li class="">Downloads entire file</li>
<li class="">Returns all data (can be GB-sized)</li>
</ul>
<p>Example performance comparison:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)"># Indexed query (fast, ~1-5 seconds)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token function" style="color:hsl(221, 87%, 60%)">time</span><span class="token plain"> bcftools view s3://my-bucket/variants.vcf.gz chr1:1-1000000 </span><span class="token operator" style="color:hsl(221, 87%, 60%)">&gt;</span><span class="token plain"> /dev/null</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)"># Without index (very slow, minutes or fails)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)"># HTSlib automatically uses index if available, so explicitly avoid it only if needed</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="54-testing-remote-file-access-with-local-files">5.4 Testing Remote File Access with Local Files<a href="#54-testing-remote-file-access-with-local-files" class="hash-link" aria-label="Direct link to 5.4 Testing Remote File Access with Local Files" title="Direct link to 5.4 Testing Remote File Access with Local Files" translate="no">​</a></h3>
<p>Before working with remote files, it&#x27;s helpful to test bcftools and samtools locally. Use this workflow to verify your installation and practice region queries.</p>
<p><strong>Create test VCF file:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)"># Create test directory</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token function" style="color:hsl(221, 87%, 60%)">mkdir</span><span class="token plain"> </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-p</span><span class="token plain"> ~/genomics-test </span><span class="token operator" style="color:hsl(221, 87%, 60%)">&amp;&amp;</span><span class="token plain"> </span><span class="token builtin class-name" style="color:hsl(35, 99%, 36%)">cd</span><span class="token plain"> ~/genomics-test</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)"># Create test VCF</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token function" style="color:hsl(221, 87%, 60%)">cat</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">&gt;</span><span class="token plain"> test.vcf </span><span class="token operator" style="color:hsl(221, 87%, 60%)">&lt;&lt;</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">&#x27;EOF&#x27;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token string" style="color:hsl(119, 34%, 47%)">##fileformat=VCFv4.2</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token string" style="color:hsl(119, 34%, 47%)">##INFO=&lt;ID=DP,Number=1,Type=Integer,Description=&quot;Total read depth&quot;&gt;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token string" style="color:hsl(119, 34%, 47%)">##FORMAT=&lt;ID=GT,Number=1,Type=String,Description=&quot;Genotype&quot;&gt;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token string" style="color:hsl(119, 34%, 47%)">#CHROM	POS	ID	REF	ALT	QUAL	FILTER	INFO	FORMAT	sample1	sample2</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token string" style="color:hsl(119, 34%, 47%)">chr1	10000	.	A	G	60	.	DP=100	GT	0/1	1/1</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token string" style="color:hsl(119, 34%, 47%)">chr1	20000	.	C	T	50	.	DP=80	GT	0/0	0/1</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token string" style="color:hsl(119, 34%, 47%)">chr1	30000	.	G	A	70	.	DP=120	GT	1/1	0/1</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token string" style="color:hsl(119, 34%, 47%)">chr1	100000	.	T	C	55	.	DP=90	GT	0/1	0/0</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token string" style="color:hsl(119, 34%, 47%)">EOF</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)"># Compress and index (requires bgzip and tabix from pixi)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">pixi run bgzip </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-f</span><span class="token plain"> test.vcf</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">pixi run tabix </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-p</span><span class="token plain"> vcf test.vcf.gz</span><br></span></code></pre></div></div>
<p><strong>Test bcftools region queries:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)"># Query specific region</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">pixi run bcftools view test.vcf.gz chr1:1-50000</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)"># Extract specific samples</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">pixi run bcftools view </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-s</span><span class="token plain"> sample1 test.vcf.gz chr1:10000-50000</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)"># Count variants in region</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">pixi run bcftools view </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-H</span><span class="token plain"> test.vcf.gz chr1:1-100000 </span><span class="token operator" style="color:hsl(221, 87%, 60%)">|</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">wc</span><span class="token plain"> </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-l</span><br></span></code></pre></div></div>
<p><strong>Create and test BAM file:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)"># Create test SAM file</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token function" style="color:hsl(221, 87%, 60%)">cat</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">&gt;</span><span class="token plain"> test.sam </span><span class="token operator" style="color:hsl(221, 87%, 60%)">&lt;&lt;</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">&#x27;EOF&#x27;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token string" style="color:hsl(119, 34%, 47%)">@HD	VN:1.0	SO:coordinate</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token string" style="color:hsl(119, 34%, 47%)">@SQ	SN:chr1	LN:1000000</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token string" style="color:hsl(119, 34%, 47%)">read1	0	chr1	100	60	10M	*	0	0	ACGTACGTAC	IIIIIIIIII</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token string" style="color:hsl(119, 34%, 47%)">read2	0	chr1	120	60	10M	*	0	0	TGCATGCATG	IIIIIIIIII</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token string" style="color:hsl(119, 34%, 47%)">read3	0	chr1	50000	60	10M	*	0	0	AAAAAAAAAA	IIIIIIIIII</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token string" style="color:hsl(119, 34%, 47%)">read4	0	chr1	100000	60	10M	*	0	0	TTTTTTTTTT	IIIIIIIIII</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token string" style="color:hsl(119, 34%, 47%)">EOF</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)"># Convert to BAM and index</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">pixi run samtools view </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-b</span><span class="token plain"> test.sam </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-o</span><span class="token plain"> test.bam</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">pixi run samtools index test.bam</span><br></span></code></pre></div></div>
<p><strong>Test samtools region queries:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)"># View reads in region</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">pixi run samtools view test.bam chr1:1-60000</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)"># Count reads in region</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">pixi run samtools view </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-c</span><span class="token plain"> test.bam chr1:1-60000</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)"># Extract region to new file</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">pixi run samtools view </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-b</span><span class="token plain"> test.bam chr1:50000-100000 </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-o</span><span class="token plain"> region.bam</span><br></span></code></pre></div></div>
<p>Once comfortable with local files, the same commands work seamlessly with remote S3, FTP, or HTTPS URLs—just replace local filenames with remote URLs.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="6-common-workflows-and-recipes">6. Common Workflows and Recipes<a href="#6-common-workflows-and-recipes" class="hash-link" aria-label="Direct link to 6. Common Workflows and Recipes" title="Direct link to 6. Common Workflows and Recipes" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="61-extract-variants-for-specific-genes">6.1 Extract Variants for Specific Genes<a href="#61-extract-variants-for-specific-genes" class="hash-link" aria-label="Direct link to 6.1 Extract Variants for Specific Genes" title="Direct link to 6.1 Extract Variants for Specific Genes" translate="no">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)"># Define gene regions (example: gene1, gene2)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token function" style="color:hsl(221, 87%, 60%)">cat</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">&gt;</span><span class="token plain"> genes.bed </span><span class="token operator" style="color:hsl(221, 87%, 60%)">&lt;&lt;</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">&#x27;EOF&#x27;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token string" style="color:hsl(119, 34%, 47%)">1	11869	14409	DDX11L1</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token string" style="color:hsl(119, 34%, 47%)">1	17369	17436	MIR6859-1</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token string" style="color:hsl(119, 34%, 47%)">EOF</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)"># Extract variants from remote file for gene regions</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">bcftools view </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  s3://my-bucket/variants.vcf.gz </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-R</span><span class="token plain"> genes.bed </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-O</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">v</span><span class="token plain"> </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-o</span><span class="token plain"> local_genes.vcf</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)"># Compress and index</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">bgzip </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-f</span><span class="token plain"> local_genes.vcf</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">tabix </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-p</span><span class="token plain"> vcf local_genes.vcf.gz</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="62-compare-samples-across-remote-files">6.2 Compare Samples Across Remote Files<a href="#62-compare-samples-across-remote-files" class="hash-link" aria-label="Direct link to 6.2 Compare Samples Across Remote Files" title="Direct link to 6.2 Compare Samples Across Remote Files" translate="no">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)"># Compare variants for two samples in different S3 files</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">bcftools isec </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token operator" style="color:hsl(221, 87%, 60%)">&lt;</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">bcftools view </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-s</span><span class="token plain"> sample1 s3://bucket1/variants.vcf.gz</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token operator" style="color:hsl(221, 87%, 60%)">&lt;</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">bcftools view </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-s</span><span class="token plain"> sample2 s3://bucket2/variants.vcf.gz</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-p</span><span class="token plain"> comparison_output</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)"># Shows shared and unique variants</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token function" style="color:hsl(221, 87%, 60%)">ls</span><span class="token plain"> comparison_output/</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="63-annotate-remote-vcf-with-remote-annotations">6.3 Annotate Remote VCF with Remote Annotations<a href="#63-annotate-remote-vcf-with-remote-annotations" class="hash-link" aria-label="Direct link to 6.3 Annotate Remote VCF with Remote Annotations" title="Direct link to 6.3 Annotate Remote VCF with Remote Annotations" translate="no">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)"># Annotate S3-hosted VCF using FTP-hosted annotation file</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">bcftools annotate </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  s3://my-bucket/variants.vcf.gz </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-a</span><span class="token plain"> ftp://ftp.ncbi.nlm.nih.gov/snp/organisms/human_9606_b150_GRCh37p13/VCF/common_all.vcf.gz </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-c</span><span class="token plain"> ID </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-O</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">v</span><span class="token plain"> </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-o</span><span class="token plain"> annotated.vcf</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="64-extract-bam-regions-for-multiple-samples">6.4 Extract BAM Regions for Multiple Samples<a href="#64-extract-bam-regions-for-multiple-samples" class="hash-link" aria-label="Direct link to 6.4 Extract BAM Regions for Multiple Samples" title="Direct link to 6.4 Extract BAM Regions for Multiple Samples" translate="no">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)"># Create list of regions</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token function" style="color:hsl(221, 87%, 60%)">cat</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">&gt;</span><span class="token plain"> regions.txt </span><span class="token operator" style="color:hsl(221, 87%, 60%)">&lt;&lt;</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">&#x27;EOF&#x27;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token string" style="color:hsl(119, 34%, 47%)">chr1:1-1000000</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token string" style="color:hsl(119, 34%, 47%)">chr2:2000000-3000000</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token string" style="color:hsl(119, 34%, 47%)">chr3:5000000-6000000</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token string" style="color:hsl(119, 34%, 47%)">EOF</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)"># Extract each region from remote BAM, save locally</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">while</span><span class="token plain"> </span><span class="token builtin class-name" style="color:hsl(35, 99%, 36%)">read</span><span class="token plain"> region</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">do</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  samtools view </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    s3://my-bucket/aligned.bam </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token variable" style="color:hsl(221, 87%, 60%)">$region</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-b</span><span class="token plain"> </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-o</span><span class="token plain"> </span><span class="token variable" style="color:hsl(221, 87%, 60%)">${region</span><span class="token variable operator" style="color:hsl(221, 87%, 60%)">/</span><span class="token variable operator" style="color:hsl(221, 87%, 60%)">/</span><span class="token variable operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token variable operator" style="color:hsl(221, 87%, 60%)">/</span><span class="token variable" style="color:hsl(221, 87%, 60%)">_}</span><span class="token plain">.bam</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  samtools index </span><span class="token variable" style="color:hsl(221, 87%, 60%)">${region</span><span class="token variable operator" style="color:hsl(221, 87%, 60%)">/</span><span class="token variable operator" style="color:hsl(221, 87%, 60%)">/</span><span class="token variable operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token variable operator" style="color:hsl(221, 87%, 60%)">/</span><span class="token variable" style="color:hsl(221, 87%, 60%)">_}</span><span class="token plain">.bam</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">done</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">&lt;</span><span class="token plain"> regions.txt</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="65-stream-processing-without-local-storage">6.5 Stream Processing Without Local Storage<a href="#65-stream-processing-without-local-storage" class="hash-link" aria-label="Direct link to 6.5 Stream Processing Without Local Storage" title="Direct link to 6.5 Stream Processing Without Local Storage" translate="no">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)"># Pipe remote data through multiple tools</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">bcftools view s3://my-bucket/variants.vcf.gz chr1:1-1000000 </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token operator" style="color:hsl(221, 87%, 60%)">|</span><span class="token plain"> bcftools query </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-f</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">&#x27;%CHROM\t%POS\t%REF\t%ALT\t%AC\t%AF\n&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token operator" style="color:hsl(221, 87%, 60%)">|</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">awk</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">&#x27;$6 &gt; 0.05&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token operator" style="color:hsl(221, 87%, 60%)">|</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">tee</span><span class="token plain"> filtered_variants.tsv </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token operator" style="color:hsl(221, 87%, 60%)">|</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">wc</span><span class="token plain"> </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-l</span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="7-troubleshooting-and-optimization">7. Troubleshooting and Optimization<a href="#7-troubleshooting-and-optimization" class="hash-link" aria-label="Direct link to 7. Troubleshooting and Optimization" title="Direct link to 7. Troubleshooting and Optimization" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="71-common-issues">7.1 Common Issues<a href="#71-common-issues" class="hash-link" aria-label="Direct link to 7.1 Common Issues" title="Direct link to 7.1 Common Issues" translate="no">​</a></h3>
<p><strong>Issue</strong>: &quot;File not found&quot; or 404 errors</p>
<ul>
<li class=""><strong>Solution</strong>: Verify S3 bucket name, path, and file permissions. Test with AWS CLI:<!-- -->
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">aws s3 </span><span class="token function" style="color:hsl(221, 87%, 60%)">ls</span><span class="token plain"> s3://bucket-name/path/file.vcf.gz</span><br></span></code></pre></div></div>
</li>
</ul>
<p><strong>Issue</strong>: Authentication failures with S3</p>
<ul>
<li class=""><strong>Solution</strong>: Verify AWS credentials:<!-- -->
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">aws sts get-caller-identity</span><br></span></code></pre></div></div>
</li>
</ul>
<p><strong>Issue</strong>: Index not found (<code>.tbi</code> or <code>.bai</code> missing)</p>
<ul>
<li class=""><strong>Solution</strong>: Create indexes or verify they exist on remote server:<!-- -->
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">aws s3 </span><span class="token function" style="color:hsl(221, 87%, 60%)">ls</span><span class="token plain"> s3://bucket-name/file.vcf.gz.tbi</span><br></span></code></pre></div></div>
</li>
</ul>
<p><strong>Issue</strong>: &quot;Connection timeout&quot; on FTP</p>
<ul>
<li class=""><strong>Solution</strong>: Increase timeout and try again:<!-- -->
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token builtin class-name" style="color:hsl(35, 99%, 36%)">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:hsl(221, 87%, 60%)">CURL_CONNECT_TIMEOUT</span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token number" style="color:hsl(35, 99%, 36%)">60</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token builtin class-name" style="color:hsl(35, 99%, 36%)">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:hsl(221, 87%, 60%)">CURL_TIMEOUT</span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token number" style="color:hsl(35, 99%, 36%)">120</span><br></span></code></pre></div></div>
</li>
</ul>
<p><strong>Issue</strong>: HTTPS SSL certificate errors</p>
<ul>
<li class=""><strong>Solution</strong>: Verify certificate validity or temporarily disable verification for testing:<!-- -->
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token function" style="color:hsl(221, 87%, 60%)">curl</span><span class="token plain"> </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-k</span><span class="token plain"> https://endpoint.com/file.vcf.gz.tbi  </span><span class="token comment" style="color:hsl(230, 4%, 64%)"># -k disables cert verification</span><br></span></code></pre></div></div>
</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="72-optimization-tips">7.2 Optimization Tips<a href="#72-optimization-tips" class="hash-link" aria-label="Direct link to 7.2 Optimization Tips" title="Direct link to 7.2 Optimization Tips" translate="no">​</a></h3>
<p><strong>For S3 Access</strong>:</p>
<ul>
<li class="">Use S3 Transfer Acceleration if available for faster downloads</li>
<li class="">Place compute resources in the same AWS region as your data</li>
<li class="">Use bucket endpoints to avoid Internet Gateway charges:<!-- -->
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)"># VPC endpoint for S3 (no data transfer charges within VPC)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">s3://bucket-name/key</span><br></span></code></pre></div></div>
</li>
</ul>
<p><strong>For Large Batch Queries</strong>:</p>
<ul>
<li class="">Sort region requests by chromosome for better caching</li>
<li class="">Consider downloading entire chromosome subset once, then querying locally:<!-- -->
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">bcftools view s3://bucket/variants.vcf.gz chr1 </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-o</span><span class="token plain"> chr1.vcf.gz</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">bcftools index chr1.vcf.gz</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)"># Then query locally multiple times</span><br></span></code></pre></div></div>
</li>
</ul>
<p><strong>For FTP Performance</strong>:</p>
<ul>
<li class="">Batch multiple queries when possible</li>
<li class="">Check server-side compression settings</li>
<li class="">Consider mirror/rsync services for frequently accessed data</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="73-debugging-with-verbose-output">7.3 Debugging with Verbose Output<a href="#73-debugging-with-verbose-output" class="hash-link" aria-label="Direct link to 7.3 Debugging with Verbose Output" title="Direct link to 7.3 Debugging with Verbose Output" translate="no">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)"># Enable verbose output for debugging</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token builtin class-name" style="color:hsl(35, 99%, 36%)">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:hsl(221, 87%, 60%)">HTS_LOG_LEVEL</span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain">debug</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)"># Use bcftools verbose flag</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">bcftools view </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-v</span><span class="token plain"> s3://bucket/variants.vcf.gz chr1:1-1000000</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)"># Check curl verbose output</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token builtin class-name" style="color:hsl(35, 99%, 36%)">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:hsl(221, 87%, 60%)">CURL_VERBOSE</span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token number" style="color:hsl(35, 99%, 36%)">1</span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="8-recap-and-key-takeaways">8. Recap and Key Takeaways<a href="#8-recap-and-key-takeaways" class="hash-link" aria-label="Direct link to 8. Recap and Key Takeaways" title="Direct link to 8. Recap and Key Takeaways" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="81-what-weve-covered">8.1 What We&#x27;ve Covered<a href="#81-what-weve-covered" class="hash-link" aria-label="Direct link to 8.1 What We&#x27;ve Covered" title="Direct link to 8.1 What We&#x27;ve Covered" translate="no">​</a></h3>
<ul>
<li class=""><strong>Protocol Support</strong>: HTSlib tools support S3, FTP, and HTTPS remote file access natively</li>
<li class=""><strong>Authentication</strong>: Each protocol has different auth mechanisms (AWS credentials, FTP user<!-- -->:pass<!-- -->, Bearer tokens)</li>
<li class=""><strong>Efficient Queries</strong>: Indexed files enable byte-range requests, downloading only necessary data</li>
<li class=""><strong>Practical Workflows</strong>: Common tasks like region extraction, sample comparison, and annotation using remote files</li>
<li class=""><strong>Troubleshooting</strong>: How to diagnose and resolve common remote file access issues</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="82-key-takeaways">8.2 Key Takeaways<a href="#82-key-takeaways" class="hash-link" aria-label="Direct link to 8.2 Key Takeaways" title="Direct link to 8.2 Key Takeaways" translate="no">​</a></h3>
<ol>
<li class=""><strong>Always use indexes</strong> for remote files to avoid downloading entire datasets</li>
<li class=""><strong>Choose the right protocol</strong>: S3 for AWS, FTP for public repositories, HTTPS for APIs</li>
<li class=""><strong>Set up authentication correctly</strong> to avoid repeated connection failures</li>
<li class=""><strong>Stream processing</strong> reduces local storage requirements for large datasets</li>
<li class=""><strong>Verify indexes exist</strong> on remote servers before querying</li>
<li class=""><strong>Optimize by region</strong>: Place compute near data, batch similar queries, use appropriate timeouts</li>
</ol>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="83-quick-reference-workflow">8.3 Quick Reference Workflow<a href="#83-quick-reference-workflow" class="hash-link" aria-label="Direct link to 8.3 Quick Reference Workflow" title="Direct link to 8.3 Quick Reference Workflow" translate="no">​</a></h3>
<p><strong>Setup (one time):</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)"># Create project directory</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token function" style="color:hsl(221, 87%, 60%)">mkdir</span><span class="token plain"> </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-p</span><span class="token plain"> ~/genomics-work </span><span class="token operator" style="color:hsl(221, 87%, 60%)">&amp;&amp;</span><span class="token plain"> </span><span class="token builtin class-name" style="color:hsl(35, 99%, 36%)">cd</span><span class="token plain"> ~/genomics-work</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)"># Initialize Pixi with conda-forge and bioconda</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">pixi init </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">--channel</span><span class="token plain"> conda-forge </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">--channel</span><span class="token plain"> bioconda </span><span class="token builtin class-name" style="color:hsl(35, 99%, 36%)">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)"># Add tools</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">pixi </span><span class="token function" style="color:hsl(221, 87%, 60%)">add</span><span class="token plain"> bcftools samtools</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)"># Verify installation</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">pixi run bcftools </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">--version</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">pixi run samtools </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">--version</span><br></span></code></pre></div></div>
<p><strong>Using remote files:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)"># 1. Set up authentication (optional, for private buckets)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token builtin class-name" style="color:hsl(35, 99%, 36%)">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:hsl(221, 87%, 60%)">AWS_ACCESS_KEY_ID</span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token string" style="color:hsl(119, 34%, 47%)">&quot;...&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token builtin class-name" style="color:hsl(35, 99%, 36%)">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:hsl(221, 87%, 60%)">AWS_SECRET_ACCESS_KEY</span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token string" style="color:hsl(119, 34%, 47%)">&quot;...&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token builtin class-name" style="color:hsl(35, 99%, 36%)">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:hsl(221, 87%, 60%)">AWS_DEFAULT_REGION</span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token string" style="color:hsl(119, 34%, 47%)">&quot;us-east-1&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)"># 2. Query real remote file (NCBI dbSNP via HTTPS - no auth needed)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">pixi run bcftools view </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  https://ftp.ncbi.nlm.nih.gov/snp/organisms/human_9606_b150_GRCh37p13/VCF/00-common_all.vcf.gz </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token operator" style="color:hsl(221, 87%, 60%)">|</span><span class="token plain"> pixi run bcftools query </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-f</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">&#x27;%CHROM\t%POS\t%REF\t%ALT\n&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token operator" style="color:hsl(221, 87%, 60%)">|</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">head</span><span class="token plain"> </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-20</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)"># 3. Or for your own S3 data:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">pixi run bcftools view s3://my-bucket/variants.vcf.gz chr1:1-1000000 </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-O</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">v</span><span class="token plain"> </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-o</span><span class="token plain"> chr1_subset.vcf</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)"># 4. Create local index for repeated use</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">pixi run bgzip </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-f</span><span class="token plain"> chr1_subset.vcf</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">pixi run tabix </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-p</span><span class="token plain"> vcf chr1_subset.vcf.gz</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="84-next-steps">8.4 Next Steps<a href="#84-next-steps" class="hash-link" aria-label="Direct link to 8.4 Next Steps" title="Direct link to 8.4 Next Steps" translate="no">​</a></h3>
<ul>
<li class=""><strong>Explore your data</strong>: Start with small region queries to test setup</li>
<li class=""><strong>Automate workflows</strong>: Create scripts for common extraction and annotation tasks</li>
<li class=""><strong>Scale up</strong>: Use Nextflow or similar workflow managers for processing multiple files</li>
<li class=""><strong>Monitor costs</strong>: Track S3 data transfer and request costs if using cloud storage</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="85-additional-resources">8.5 Additional Resources<a href="#85-additional-resources" class="hash-link" aria-label="Direct link to 8.5 Additional Resources" title="Direct link to 8.5 Additional Resources" translate="no">​</a></h3>
<ul>
<li class=""><a href="http://www.htslib.org/doc/" target="_blank" rel="noopener noreferrer" class="">HTSlib documentation</a></li>
<li class=""><a href="http://www.htslib.org/doc/bcftools.html" target="_blank" rel="noopener noreferrer" class="">bcftools manual</a></li>
<li class=""><a href="http://www.htslib.org/doc/samtools.html" target="_blank" rel="noopener noreferrer" class="">samtools manual</a></li>
<li class=""><a href="https://www.internationalgenome.org/" target="_blank" rel="noopener noreferrer" class="">1000 Genomes Project</a></li>
<li class=""><a href="https://www.ensembl.org/biomart/martview" target="_blank" rel="noopener noreferrer" class="">Ensembl Biomart</a></li>
</ul></div><footer class="docusaurus-mt-lg"><div class="row margin-top--sm theme-blog-footer-edit-meta-row"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/river-docs/blog/tags/bioinformatics">bioinformatics</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/river-docs/blog/tags/htslib">htslib</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/river-docs/blog/tags/bcftools">bcftools</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/river-docs/blog/tags/samtools">samtools</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/river-docs/blog/tags/s-3">s3</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/river-docs/blog/tags/remote-files">remote-files</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/river-docs/blog/tags/cloud">cloud</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/river-docs/blog/tags/genomics">genomics</a></li></ul></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><a class="pagination-nav__link pagination-nav__link--next" href="/river-docs/blog/setup-local-nextflow-training"><div class="pagination-nav__sublabel">Older post</div><div class="pagination-nav__label">Setting Up a Local Nextflow Training Environment with Code-Server and HPC</div></a></nav></main><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#1-how-htslib-handles-remote-files-with-random-access" class="table-of-contents__link toc-highlight">1. How HTSlib Handles Remote Files with Random Access</a><ul><li><a href="#11-random-access-mechanism-the-foundation" class="table-of-contents__link toc-highlight">1.1 Random Access Mechanism: The Foundation</a></li><li><a href="#12-all-supported-url-schemes" class="table-of-contents__link toc-highlight">1.2 All Supported URL Schemes</a></li><li><a href="#13-typical-bioinformatics-protocols-covered-in-this-blog" class="table-of-contents__link toc-highlight">1.3 Typical Bioinformatics Protocols (Covered in This Blog)</a><ul><li><a href="#s3-amazon-s3-and-compatible" class="table-of-contents__link toc-highlight">S3 (Amazon S3 and compatible)</a></li><li><a href="#https-web-servers" class="table-of-contents__link toc-highlight">HTTPS (Web servers)</a></li><li><a href="#ftp-file-transfer-protocol" class="table-of-contents__link toc-highlight">FTP (File Transfer Protocol)</a></li><li><a href="#gcs-google-cloud-storage" class="table-of-contents__link toc-highlight">GCS (Google Cloud Storage)</a></li></ul></li><li><a href="#14-key-advantages-of-remote-access" class="table-of-contents__link toc-highlight">1.4 Key Advantages of Remote Access</a></li><li><a href="#15-performance-considerations-why-indexes-matter" class="table-of-contents__link toc-highlight">1.5 Performance Considerations: Why Indexes Matter</a></li><li><a href="#16-setting-up-bcftools-and-samtools-with-pixi" class="table-of-contents__link toc-highlight">1.6 Setting Up bcftools and samtools with Pixi</a><ul><li><a href="#installation-steps" class="table-of-contents__link toc-highlight">Installation Steps</a></li><li><a href="#verify-installation" class="table-of-contents__link toc-highlight">Verify Installation</a></li><li><a href="#why-pixi-for-remote-file-access" class="table-of-contents__link toc-highlight">Why Pixi for Remote File Access?</a></li></ul></li><li><a href="#17-protocol-verification-http-range-requests" class="table-of-contents__link toc-highlight">1.7 Protocol Verification: HTTP Range Requests</a></li></ul></li><li><a href="#2-s3-remote-file-access" class="table-of-contents__link toc-highlight">2. S3 Remote File Access</a><ul><li><a href="#21-s3-authentication" class="table-of-contents__link toc-highlight">2.1 S3 Authentication</a><ul><li><a href="#using-aws-credentials" class="table-of-contents__link toc-highlight">Using AWS Credentials</a></li><li><a href="#using-aws-iam-roles-ec2-instances" class="table-of-contents__link toc-highlight">Using AWS IAM Roles (EC2 Instances)</a></li><li><a href="#using-aws-cli-configuration" class="table-of-contents__link toc-highlight">Using AWS CLI Configuration</a></li></ul></li><li><a href="#22-querying-s3-hosted-vcf-files" class="table-of-contents__link toc-highlight">2.2 Querying S3-hosted VCF Files</a></li><li><a href="#23-querying-s3-hosted-bam-files" class="table-of-contents__link toc-highlight">2.3 Querying S3-hosted BAM Files</a></li><li><a href="#24-region-based-subsetting-workflow" class="table-of-contents__link toc-highlight">2.4 Region-based Subsetting Workflow</a></li><li><a href="#25-working-with-public-genomic-data" class="table-of-contents__link toc-highlight">2.5 Working with Public Genomic Data</a></li></ul></li><li><a href="#3-ftp-remote-file-access" class="table-of-contents__link toc-highlight">3. FTP Remote File Access</a><ul><li><a href="#31-ftp-authentication" class="table-of-contents__link toc-highlight">3.1 FTP Authentication</a><ul><li><a href="#anonymous-access" class="table-of-contents__link toc-highlight">Anonymous Access</a></li><li><a href="#authenticated-ftp" class="table-of-contents__link toc-highlight">Authenticated FTP</a></li></ul></li><li><a href="#32-querying-ftp-hosted-files" class="table-of-contents__link toc-highlight">3.2 Querying FTP-hosted Files</a><ul><li><a href="#ncbi-ftp-repository" class="table-of-contents__link toc-highlight">NCBI FTP Repository</a></li><li><a href="#ensembl-ftp-repository" class="table-of-contents__link toc-highlight">Ensembl FTP Repository</a></li></ul></li><li><a href="#33-ftp-performance-tips" class="table-of-contents__link toc-highlight">3.3 FTP Performance Tips</a></li></ul></li><li><a href="#4-https-remote-file-access" class="table-of-contents__link toc-highlight">4. HTTPS Remote File Access</a><ul><li><a href="#41-https-authentication-methods" class="table-of-contents__link toc-highlight">4.1 HTTPS Authentication Methods</a><ul><li><a href="#bearer-token-authentication" class="table-of-contents__link toc-highlight">Bearer Token Authentication</a></li><li><a href="#api-keys-in-headers" class="table-of-contents__link toc-highlight">API Keys in Headers</a></li><li><a href="#basic-http-authentication" class="table-of-contents__link toc-highlight">Basic HTTP Authentication</a></li></ul></li><li><a href="#42-practical-https-workflows" class="table-of-contents__link toc-highlight">4.2 Practical HTTPS Workflows</a><ul><li><a href="#query-public-https-hosted-data" class="table-of-contents__link toc-highlight">Query Public HTTPS-hosted Data</a></li><li><a href="#download-indexed-files-locally" class="table-of-contents__link toc-highlight">Download Indexed Files Locally</a></li></ul></li><li><a href="#43-ssltls-certificate-issues" class="table-of-contents__link toc-highlight">4.3 SSL/TLS Certificate Issues</a></li></ul></li><li><a href="#5-indexing-and-efficient-region-queries" class="table-of-contents__link toc-highlight">5. Indexing and Efficient Region Queries</a><ul><li><a href="#51-creating-indexes" class="table-of-contents__link toc-highlight">5.1 Creating Indexes</a><ul><li><a href="#create-tabix-index-for-vcf-files" class="table-of-contents__link toc-highlight">Create Tabix Index for VCF Files</a></li><li><a href="#create-csi-index-for-bcf-files" class="table-of-contents__link toc-highlight">Create CSI Index for BCF Files</a></li><li><a href="#create-bai-index-for-bam-files" class="table-of-contents__link toc-highlight">Create BAI Index for BAM Files</a></li></ul></li><li><a href="#52-verifying-index-integrity" class="table-of-contents__link toc-highlight">5.2 Verifying Index Integrity</a></li><li><a href="#53-performance-indexed-vs-unindexed-remote-access" class="table-of-contents__link toc-highlight">5.3 Performance: Indexed vs Unindexed Remote Access</a></li><li><a href="#54-testing-remote-file-access-with-local-files" class="table-of-contents__link toc-highlight">5.4 Testing Remote File Access with Local Files</a></li></ul></li><li><a href="#6-common-workflows-and-recipes" class="table-of-contents__link toc-highlight">6. Common Workflows and Recipes</a><ul><li><a href="#61-extract-variants-for-specific-genes" class="table-of-contents__link toc-highlight">6.1 Extract Variants for Specific Genes</a></li><li><a href="#62-compare-samples-across-remote-files" class="table-of-contents__link toc-highlight">6.2 Compare Samples Across Remote Files</a></li><li><a href="#63-annotate-remote-vcf-with-remote-annotations" class="table-of-contents__link toc-highlight">6.3 Annotate Remote VCF with Remote Annotations</a></li><li><a href="#64-extract-bam-regions-for-multiple-samples" class="table-of-contents__link toc-highlight">6.4 Extract BAM Regions for Multiple Samples</a></li><li><a href="#65-stream-processing-without-local-storage" class="table-of-contents__link toc-highlight">6.5 Stream Processing Without Local Storage</a></li></ul></li><li><a href="#7-troubleshooting-and-optimization" class="table-of-contents__link toc-highlight">7. Troubleshooting and Optimization</a><ul><li><a href="#71-common-issues" class="table-of-contents__link toc-highlight">7.1 Common Issues</a></li><li><a href="#72-optimization-tips" class="table-of-contents__link toc-highlight">7.2 Optimization Tips</a></li><li><a href="#73-debugging-with-verbose-output" class="table-of-contents__link toc-highlight">7.3 Debugging with Verbose Output</a></li></ul></li><li><a href="#8-recap-and-key-takeaways" class="table-of-contents__link toc-highlight">8. Recap and Key Takeaways</a><ul><li><a href="#81-what-weve-covered" class="table-of-contents__link toc-highlight">8.1 What We&#39;ve Covered</a></li><li><a href="#82-key-takeaways" class="table-of-contents__link toc-highlight">8.2 Key Takeaways</a></li><li><a href="#83-quick-reference-workflow" class="table-of-contents__link toc-highlight">8.3 Quick Reference Workflow</a></li><li><a href="#84-next-steps" class="table-of-contents__link toc-highlight">8.4 Next Steps</a></li><li><a href="#85-additional-resources" class="table-of-contents__link toc-highlight">8.5 Additional Resources</a></li></ul></li></ul></div></div></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/river-docs/docs/overview">Tutorial</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/river-docs/blog">Blog</a></li><li class="footer__item"><a href="https://www.facebook.com/groups/1134438583997171" target="_blank" rel="noopener noreferrer" class="footer__link-item">Facebook<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://github.com/riverxdata/river" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://riverxdata.github.io" target="_blank" rel="noopener noreferrer" class="footer__link-item">About RiverXData<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">© 2026 RiverXData</div></div></div></footer></div>
</body>
</html>