---
slug: reproducible-bioinformatics-docker-install
title: "Reproducible Bioinformatics Analysis: Installing Tools and Building Efficient Docker Images from Scratch"
authors: [river]
tags: [docker, reproducibility, bioinformatics, best-practices]
image: ./imgs/intro.png
draft: true
---

<!-- truncate -->

## Introduction

Reproducibility is one of the cornerstones of modern bioinformatics research. As computations become more complex and software-dependent, ensuring that your environment and analyses can be exactly recreated is critical for transparency, collaboration, and long-term project value. This guide walks you through setting up a reproducible bioinformatics environment from scratch using Docker, while following industry best practices for efficient image builds.

---

## Containers vs. Virtual Machines: What’s the Difference?

**Virtual Machines (VMs):**
- Emulate complete computers—a guest OS runs atop a hypervisor on host hardware.
- Each VM contains its own operating system, libraries, and the app.
- VMs are isolated and portable but can be heavy, slower to start, and consume more resources.

**Containers:**
- Package application code plus its dependencies—share the host OS kernel.
- Multiple containers run on the same OS, isolated at the process level.
- Containers are lightweight, start instantly, require fewer resources, and are portable.

| Factor         | Virtual Machine                | Container                                        |
| -------------- | ------------------------------ | ------------------------------------------------ |
| Isolation      | OS-level (strong)              | Process-level (moderate)                         |
| Overhead       | High (whole OS per VM)         | Low                                              |
| Startup Speed  | Slow (minutes)                 | Fast (seconds)                                   |
| Resource Usage | High (dedicated OS + app)      | Low (shared OS)                                  |
| Portability    | High (hardware & OS agnostic)  | High (app focused)                               |
| Use Case       | Legacy apps, complete OS needs | Microservices, portability, reproducible science |

---

## Popular Container Technologies in Bioinformatics

- **Docker:** Dominant platform for development and distribution, beginner-friendly, huge ecosystem, supports DockerHub.
- **Podman:** Docker-compatible CLI, rootless, used for security-focused setups.
- **Singularity/Apptainer:** Designed for HPC and scientific workflows, better security model for clusters, sometimes easier to run in restricted environments.
- **LXC/LXD:** Lower-level Linux containers, more manual setup, used for system-level containerization.

---

## Why Use Docker?

- Massive community and documentation.
- Integrates with cloud and local environments seamlessly.
- Easy image creation, sharing on Docker Hub.
- Standard for reproducible research and pipelines (Nextflow, nf-core, many scientific journals require Docker support).
- Most tutorials, tools, and workflows use Docker syntax and conventions.

---

## Why Use Docker for Bioinformatics?

- **Portability:** Docker images can run on any system with Docker installed.
- **Reproducibility:** The same code and environment means identical results, regardless of host system differences.
- **Efficient Sharing:** Collaborators can pull, run, or build your analysis environment with a single command.

---

## Example: Installing Bioinformatics Tools with Docker

Let’s walk through building a Docker image that installs two staple tools: `samtools` and `bcftools`.

### Example Dockerfile
```dockerfile
# Start with a minimal, trusted base image
FROM ubuntu:24.04
LABEL maintainer="Thanh-Giang Tan Nguyen <nttg8100@gmail.com>"

# Avoid interactive prompts
ENV DEBIAN_FRONTEND=noninteractive

# Install required bioinformatics tools and cleanup to keep the image small
RUN apt-get update && \
    apt-get install -y --no-install-recommends \
        ca-certificates \
        wget \
        curl \
        samtools \
        bcftools && \
    apt-get clean && \
    rm -rf /var/lib/apt/lists/*

# Set working directory
WORKDIR /data

# Default to launching /bin/bash
CMD ["/bin/bash"]
```

#### Key Dockerfile Best Practices Incorporated
- **Trusted Base:** Uses new Ubuntu LTS from the official Docker registry
- **Layer Minimization & Clean-up:** Single `RUN` block does all installs and cleans cache/files
- **Pin Dependencies:** You can specify exact versions for core tools if strict reproducibility is needed
- **.dockerignore file:** Use one to avoid copying unnecessary files into the build context

---

## Building the Docker Image

In your project directory (where your Dockerfile lives):

```bash
docker build -t bioinfo:tools .
```

To pull the latest dependencies every time:
```bash
docker build --pull --no-cache -t bioinfo:tools .
```

---

## Running the Container

Mount your data and run interactively:
```bash
docker run -it --rm -v $PWD:/data bioinfo:tools
```

This creates a shell inside the container with your working directory mounted at `/data`.

---

## Reproducibility Tips

- **Pin Tool Versions:** Use e.g. `samtools=1.15.1` in the install line and base images with sha digests
- **Use Multi-Stage Builds:** Especially if compiling or installing from source, build in one stage, then copy only binaries/scripts to a slim final image
- **Rebuild Regularly:** To catch security updates, use `--pull` and re-build often
- **Test Your Image:** Use CI/CD to automatically build and test

---

## Sample Multi-Stage Build (if compiling tools)

```dockerfile
FROM ubuntu:24.04 as builder
RUN apt-get update && \
    apt-get install -y --no-install-recommends build-essential wget
RUN wget https://github.com/samtools/samtools/releases/download/1.18/samtools-1.18.tar.bz2 && \
    tar -xjf samtools-1.18.tar.bz2 && \
    cd samtools-1.18 && \
    ./configure --prefix=/usr/local && make && make install

FROM ubuntu:24.04
RUN apt-get update && apt-get install -y --no-install-recommends libbz2-1.0 liblzma5 zlib1g
COPY --from=builder /usr/local/bin/samtools /usr/local/bin/
WORKDIR /data
CMD ["/bin/bash"]
```

---

## Further Optimizations
- Use official [DockerHub bioinformatics images](https://hub.docker.com/search?q=bioinformatics) for common stacks or inspiration
- Leverage `.dockerignore` to exclude unneeded files and speed up builds
- Add metadata labels for traceability
- Prefer small base images and remove intermediate build dependencies

---

## References & Resources
- [Docker Official Best Practices](https://docs.docker.com/develop/dev-best-practices/)
- [nf-core guide on Docker for reproducible pipelines](https://nf-co.re/docs/usage/docker)
- [Popular bioinformatics Docker images](https://hub.docker.com/search?q=bioinformatics)

---

By following these steps and principles, your bioinformatics workflows will be easy to share, rerun, and extend by anyone, anywhere.
