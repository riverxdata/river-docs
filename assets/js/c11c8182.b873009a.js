"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[5840],{7280:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>d,contentTitle:()=>c,default:()=>h,frontMatter:()=>o,metadata:()=>r,toc:()=>t});const r=JSON.parse('{"id":"high-performance-computing/how-to-build-slurm-scalable-using-ansible/administration","title":"Administration","description":"Quick review:","source":"@site/docs/3.high-performance-computing/4.how-to-build-slurm-scalable-using-ansible/3.administration.md","sourceDirName":"3.high-performance-computing/4.how-to-build-slurm-scalable-using-ansible","slug":"/high-performance-computing/how-to-build-slurm-scalable-using-ansible/administration","permalink":"/river-docs/docs/high-performance-computing/how-to-build-slurm-scalable-using-ansible/administration","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":3,"frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Deployment","permalink":"/river-docs/docs/high-performance-computing/how-to-build-slurm-scalable-using-ansible/deployment"},"next":{"title":"Overview","permalink":"/river-docs/docs/river/challenge-to-setup-developing-environment-for-engineers"}}');var l=s(4848),i=s(8453);const o={},c="Administration",d={},t=[{value:"Monitor management",id:"monitor-management",level:2},{value:"Computing resource managements",id:"computing-resource-managements",level:2},{value:"Node management",id:"node-management",level:2},{value:"Checking SLURM Logs",id:"checking-slurm-logs",level:3},{value:"Checking Logs",id:"checking-logs",level:3}];function a(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.header,{children:(0,l.jsx)(n.h1,{id:"administration",children:"Administration"})}),"\n",(0,l.jsx)(n.p,{children:"Quick review:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Cluster"}),": Build, maintain, and update the cluster via the ",(0,l.jsx)(n.a,{href:"/river-docs/docs/high-performance-computing/how-to-build-slurm-scalable-using-ansible/overview",children:(0,l.jsx)(n.strong,{children:"RIVERXADATA SLURM cluster"})})]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Users"}),": Synchronize the users between nodes ",(0,l.jsx)(n.a,{href:"/river-docs/docs/high-performance-computing/how-to-build-slurm-scalable-using-ansible/overview",children:(0,l.jsx)(n.strong,{children:"Sync User at section 5"})})]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Login"}),": Set up the ",(0,l.jsx)(n.a,{href:"/river-docs/docs/administration/ssh-remote-server",children:(0,l.jsx)(n.strong,{children:"SSH server"})})," that allows users to log in with 2FA or required key pairs"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Permissions"}),": Set the appropriate permissions for users and groups"]}),"\n"]}),"\n",(0,l.jsx)(n.admonition,{type:"warning",children:(0,l.jsx)(n.p,{children:"If a user is in the docker group, they can gain root permissions. Do not add users to this group unless they are administrators. Consider using docker-rootless/apptainer instead."})}),"\n",(0,l.jsx)(n.h2,{id:"monitor-management",children:"Monitor management"}),"\n",(0,l.jsx)(n.p,{children:"According to the cluster manag"}),"\n",(0,l.jsx)(n.h2,{id:"computing-resource-managements",children:"Computing resource managements"}),"\n",(0,l.jsxs)(n.p,{children:["To add users, groups, and limit their resources using ",(0,l.jsx)(n.code,{children:"sacctmgr"}),", follow these steps:"]}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Add a new group"}),":"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-sh",children:"sacctmgr add account <group_name>\n"})}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Add a new user to a group"}),":"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-sh",children:"sacctmgr add user <username> account=<group_name>\n"})}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Set resource limits for a group"}),":"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-sh",children:"sacctmgr modify account <group_name> set GrpCPUMins=<cpu_minutes> GrpMem=<memory_limit>\n"})}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Set resource limits for a user"}),":"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-sh",children:"sacctmgr modify user <username> set MaxJobs=<max_jobs> MaxSubmitJobs=<max_submit_jobs>\n"})}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.p,{children:["Replace ",(0,l.jsx)(n.code,{children:"<group_name>"}),", ",(0,l.jsx)(n.code,{children:"<username>"}),", ",(0,l.jsx)(n.code,{children:"<cpu_minutes>"}),", ",(0,l.jsx)(n.code,{children:"<memory_limit>"}),", ",(0,l.jsx)(n.code,{children:"<max_jobs>"}),", and ",(0,l.jsx)(n.code,{children:"<max_submit_jobs>"})," with the appropriate values."]}),"\n",(0,l.jsx)(n.h2,{id:"node-management",children:"Node management"}),"\n",(0,l.jsx)(n.h3,{id:"checking-slurm-logs",children:"Checking SLURM Logs"}),"\n",(0,l.jsxs)(n.p,{children:["To manage and troubleshoot SLURM components (",(0,l.jsx)(n.code,{children:"slurmdbd"}),", ",(0,l.jsx)(n.code,{children:"slurmd"}),", ",(0,l.jsx)(n.code,{children:"slurmctld"}),"), follow these steps to check their logs located in ",(0,l.jsx)(n.code,{children:"/var/log/slurm/"}),":"]}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Access the Node:"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"SSH into the node where the SLURM component is running."}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Locate SLURM Log Files:"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["SLURM log files are typically located in the ",(0,l.jsx)(n.code,{children:"/var/log/slurm/"})," directory. Common log files include:","\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"/var/log/slurm/slurmdbd.log"})," - SLURM database daemon log."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"/var/log/slurm/slurmd.log"})," - SLURM node daemon log."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"/var/log/slurm/slurmctld.log"})," - SLURM controller daemon log."]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"View SLURM Logs:"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["Use commands like ",(0,l.jsx)(n.code,{children:"cat"}),", ",(0,l.jsx)(n.code,{children:"less"}),", ",(0,l.jsx)(n.code,{children:"more"}),", or ",(0,l.jsx)(n.code,{children:"tail"})," to view the log files. For example:","\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-sh",children:"tail -f /var/log/slurm/slurmctld.log\n"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Filter SLURM Logs:"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["Use ",(0,l.jsx)(n.code,{children:"grep"})," to filter logs for specific keywords. For example:","\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-sh",children:'grep "error" /var/log/slurm/slurmd.log\n'})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Check SLURM Configuration:"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["Ensure that the SLURM configuration files (",(0,l.jsx)(n.code,{children:"/etc/slurm/slurm.conf"})," and related files) are correctly set up."]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Verify SLURM Daemon Status:"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["Check the status of SLURM daemons to ensure they are running properly. For example:","\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-sh",children:"systemctl status slurmctld\n"})}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:"By following these steps, you can effectively manage and troubleshoot SLURM components by checking their logs."}),"\n",(0,l.jsx)(n.h3,{id:"checking-logs",children:"Checking Logs"}),"\n",(0,l.jsx)(n.p,{children:"To manage and troubleshoot nodes effectively, it's essential to check the logs. Assuming the rsyslog server and client are already installed, follow these steps to check the logs:"}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Access the Node:"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"SSH into the node you want to check the logs for."}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Locate Log Files:"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["Log files are typically located in the ",(0,l.jsx)(n.code,{children:"/var/log/"})," directory. Common log files include:","\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"/var/log/syslog"})," - General system log."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"/var/log/auth.log"})," - Authentication log."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"/var/log/kern.log"})," - Kernel log."]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"View Logs:"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["Use commands like ",(0,l.jsx)(n.code,{children:"cat"}),", ",(0,l.jsx)(n.code,{children:"less"}),", ",(0,l.jsx)(n.code,{children:"more"}),", or ",(0,l.jsx)(n.code,{children:"tail"})," to view the log files. For example:","\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-sh",children:"tail -f /var/log/syslog\n"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Filter Logs:"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["Use ",(0,l.jsx)(n.code,{children:"grep"})," to filter logs for specific keywords. For example:","\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-sh",children:'grep "error" /var/log/syslog\n'})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Check rsyslog Configuration:"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["Ensure that the rsyslog configuration files (",(0,l.jsx)(n.code,{children:"/etc/rsyslog.conf"})," and files in ",(0,l.jsx)(n.code,{children:"/etc/rsyslog.d/"}),") are correctly set up to forward logs to the rsyslog server."]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Verify Log Forwarding:"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["On the rsyslog server, check the logs to ensure that logs from the client nodes are being received. Logs are usually stored in ",(0,l.jsx)(n.code,{children:"/var/log/"})," on the server as well."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:"By following these steps, you can effectively manage and troubleshoot nodes by checking their logs."})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(a,{...e})}):a(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>o,x:()=>c});var r=s(6540);const l={},i=r.createContext(l);function o(e){const n=r.useContext(i);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:o(e.components),r.createElement(i.Provider,{value:n},e.children)}}}]);