"use strict";(globalThis.webpackChunkmy_website=globalThis.webpackChunkmy_website||[]).push([[4009],{93094(e,n,i){i.r(n),i.d(n,{assets:()=>a,contentTitle:()=>l,default:()=>h,frontMatter:()=>t,metadata:()=>r,toc:()=>c});var r=i(43397),s=i(74848),o=i(28453);const t={slug:"bioinformatics-containers-build-efficient-docker",title:"Containers in Bioinformatics: Community Tooling and Efficient Docker Building",authors:["river"],tags:["docker","bioinformatics","bioconda","nextflow","best-practices"],image:"./imgs/intro.png"},l=void 0,a={image:i(29831).A,authorsImageUrls:[void 0]},c=[{value:"Prerequisites: Get Docker Installed and Running",id:"prerequisites-get-docker-installed-and-running",level:2},{value:"Start Here First",id:"start-here-first",level:3},{value:"What You Need to Know",id:"what-you-need-to-know",level:3},{value:"About This Blog",id:"about-this-blog",level:3},{value:"Prerequisites Checklist",id:"prerequisites-checklist",level:3},{value:"1. Why Manual Installation Fails: The Old Way vs. Modern Containers",id:"1-why-manual-installation-fails-the-old-way-vs-modern-containers",level:2},{value:"The Modern Solution: Containers and Community Tooling",id:"the-modern-solution-containers-and-community-tooling",level:3},{value:"2. Using Docker Containers for Bioinformatics Data Analysis",id:"2-using-docker-containers-for-bioinformatics-data-analysis",level:2},{value:"Example: Run FastQC from a Container",id:"example-run-fastqc-from-a-container",level:3},{value:"Running Containers Interactively",id:"running-containers-interactively",level:3},{value:"Debugging and Inspecting a Running Docker Container",id:"debugging-and-inspecting-a-running-docker-container",level:3},{value:"ENTRYPOINT and Overriding Commands",id:"entrypoint-and-overriding-commands",level:3},{value:"Running Containers with Nextflow: Inspecting the Actual Docker Commands",id:"running-containers-with-nextflow-inspecting-the-actual-docker-commands",level:3},{value:"Where Nextflow Stores Docker Commands",id:"where-nextflow-stores-docker-commands",level:4},{value:"Viewing the Actual Docker Command",id:"viewing-the-actual-docker-command",level:4},{value:"Example: Nextflow Docker Command for VEP (Variant Effect Predictor)",id:"example-nextflow-docker-command-for-vep-variant-effect-predictor",level:4},{value:"Breaking Down the Docker Command",id:"breaking-down-the-docker-command",level:4},{value:"Re-Running a Failed Task Manually",id:"re-running-a-failed-task-manually",level:4},{value:"Key Nextflow Docker Features",id:"key-nextflow-docker-features",level:4},{value:"Profiling and Optimization",id:"profiling-and-optimization",level:4},{value:"Summary",id:"summary",level:3},{value:"3. Efficient Docker Container Building for Bioinformatics",id:"3-efficient-docker-container-building-for-bioinformatics",level:2},{value:"Best Practices",id:"best-practices",level:3},{value:"Minimal Example: Install a Tool",id:"minimal-example-install-a-tool",level:3},{value:"Multi-Stage Build Example: Build from Source",id:"multi-stage-build-example-build-from-source",level:3},{value:"Further Optimizations",id:"further-optimizations",level:3},{value:"4. Building Docker Images with Conda and Micromamba",id:"4-building-docker-images-with-conda-and-micromamba",level:2},{value:"Why Micromamba for Docker Images?",id:"why-micromamba-for-docker-images",level:3},{value:"The Modern Approach: Conda.yml + Micromamba",id:"the-modern-approach-condayml--micromamba",level:3},{value:"Understanding the Dockerfile",id:"understanding-the-dockerfile",level:3},{value:"Why procps-ng is Important for Nextflow",id:"why-procps-ng-is-important-for-nextflow",level:3},{value:"Complete Multi-Tool Example",id:"complete-multi-tool-example",level:3},{value:"Building and Using Your Container",id:"building-and-using-your-container",level:3},{value:"Advantages of This Approach",id:"advantages-of-this-approach",level:3},{value:"Saving and Sharing Explicit Lock Files",id:"saving-and-sharing-explicit-lock-files",level:3},{value:"Pixi: The Next Generation Tool for Conda-Based Containers",id:"pixi-the-next-generation-tool-for-conda-based-containers",level:3},{value:"5. Finding Pre-Built Containers: Before Building from Scratch",id:"5-finding-pre-built-containers-before-building-from-scratch",level:2},{value:"The Container Search Strategy",id:"the-container-search-strategy",level:3},{value:"1. BioContainers (Primary Source)",id:"1-biocontainers-primary-source",level:3},{value:"2. Seqera Containers (Also support Multi-Tool Option)",id:"2-seqera-containers-also-support-multi-tool-option",level:3},{value:"3. When to Build from Scratch",id:"3-when-to-build-from-scratch",level:3},{value:"Quick Reference: Where to Find Each Tool",id:"quick-reference-where-to-find-each-tool",level:3},{value:"Practical Workflow: Search \u2192 Pull \u2192 Use",id:"practical-workflow-search--pull--use",level:3},{value:"Best Practices for Using Pre-Built Containers",id:"best-practices-for-using-pre-built-containers",level:3},{value:"Summary: Container Registry Decision Tree",id:"summary-container-registry-decision-tree",level:3}];function d(e){const n={a:"a",code:"code",em:"em",h2:"h2",h3:"h3",h4:"h4",hr:"hr",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,o.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.p,{children:"Docker containers are revolutionizing bioinformatics by automating reproducibility and portability across platforms. But what problems can they actually solve? This post shows real-world applications of containers in bioinformatics workflows, then guides you through the simplest possible ways to use, build and debug them."}),"\n",(0,s.jsx)(n.h2,{id:"prerequisites-get-docker-installed-and-running",children:"Prerequisites: Get Docker Installed and Running"}),"\n",(0,s.jsxs)(n.p,{children:["Before reading this blog, ",(0,s.jsx)(n.strong,{children:"you need Docker installed on your system"}),". This blog assumes you already have Docker up and running and covers how to effectively use containers for bioinformatics work."]}),"\n",(0,s.jsx)(n.h3,{id:"start-here-first",children:"Start Here First"}),"\n",(0,s.jsx)(n.p,{children:"If Docker is not yet installed on your machine, visit the official Docker documentation:"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsxs)(n.strong,{children:["\ud83d\udce6 ",(0,s.jsx)(n.a,{href:"https://docs.docker.com/get-started/get-docker/",children:"https://docs.docker.com/get-started/get-docker/"})]})}),"\n",(0,s.jsx)(n.p,{children:"This guide will walk you through:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Installing Docker Desktop"})," (Mac, Windows, Linux)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Verifying your installation"})," with ",(0,s.jsx)(n.code,{children:"docker --version"})]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Running your first container"})," with ",(0,s.jsx)(n.code,{children:"docker run hello-world"})]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Understanding Docker basics"})," (images, containers, registries)"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"what-you-need-to-know",children:"What You Need to Know"}),"\n",(0,s.jsx)(n.p,{children:"After installing Docker, verify it's working:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"# Check Docker version\ndocker --version\n# Output: Docker version 24.0.0, build 12345abc\n\n# Run a test container\ndocker run hello-world\n# Output: Hello from Docker! This message shows that your installation appears to be working correctly.\n"})}),"\n",(0,s.jsx)(n.h3,{id:"about-this-blog",children:"About This Blog"}),"\n",(0,s.jsx)(n.p,{children:"Once Docker is installed and working, this blog will teach you:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Why manual installation fails"})," and how containers solve reproducibility problems"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"How to use Docker containers"})," for bioinformatics data analysis"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"How to build efficient Docker images"})," with best practices"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"How to build containers with Micromamba and Pixi"})," for bioinformatics workflows"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"How to find pre-built containers"})," before building from scratch"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"prerequisites-checklist",children:"Prerequisites Checklist"}),"\n",(0,s.jsx)(n.p,{children:"Before continuing, verify you have:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\u2705 Docker installed (",(0,s.jsx)(n.code,{children:"docker --version"})," works)"]}),"\n",(0,s.jsx)(n.li,{children:"\u2705 Docker daemon running (or Docker Desktop active)"}),"\n",(0,s.jsxs)(n.li,{children:["\u2705 Can pull images (",(0,s.jsx)(n.code,{children:"docker pull hello-world"})," works)"]}),"\n",(0,s.jsx)(n.li,{children:"\u2705 Basic familiarity with command line/terminal"}),"\n",(0,s.jsx)(n.li,{children:"\u2705 (Optional but helpful) Nextflow installed for pipeline examples"}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Not ready?"})," Go to ",(0,s.jsx)(n.a,{href:"https://docs.docker.com/get-started/get-docker/",children:"https://docs.docker.com/get-started/get-docker/"})," first, then come back here!"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"1-why-manual-installation-fails-the-old-way-vs-modern-containers",children:"1. Why Manual Installation Fails: The Old Way vs. Modern Containers"}),"\n",(0,s.jsx)(n.p,{children:"Traditionally, bioinformatics labs installed software on shared servers or laptops using commands like:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"sudo apt-get install samtools bwa python3\n"})}),"\n",(0,s.jsx)(n.p,{children:"While this seems easy, it creates major reproducibility, portability, and maintenance headaches:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Manual Steps:"})," Each researcher (or lab) performs installs slightly differently. Written instructions, scripts, and troubleshooting steps are often lost, mixed, or outdated."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Not Reproducible:"}),' No record of what was installed, which versions, or the exact order. Over time, software updates, conflicts, and broken dependencies accumulate, leading to the "works for me" problem.']}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Hard to Debug:"})," Version mismatches, library conflicts, and subtle errors are almost impossible to diagnose or fix once the environment drifts."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Not Portable:"})," Scripts break on macOS, Windows, or other Linux variants. HPC systems often restrict sudo/root access, making traditional installs impossible."]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Result:"})," Collaboration across labs, institutions, or countries becomes fragile. Reproducing results\u2014even on your own machine\u2014can be a challenge!"]}),"\n",(0,s.jsx)(n.h3,{id:"the-modern-solution-containers-and-community-tooling",children:"The Modern Solution: Containers and Community Tooling"}),"\n",(0,s.jsx)(n.p,{children:"Today, bioinformatics has largely replaced manual installs with containers and environment managers:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"BioConda:"})," Over 8000 bioinformatics packages can be installed reproducibly via Conda."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"BioContainers:"})," Automatically generates Docker containers for each tool, available at ",(0,s.jsx)(n.a,{href:"https://quay.io/organization/biocontainers",children:"quay.io/biocontainers"}),".","\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"docker pull quay.io/biocontainers/samtools:1.15.1--h1170115_0\n"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Seqera/Nextflow/nf-core:"})," Pipelines with environment definitions (Conda, Docker, Singularity) are shared and run identically everywhere."]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.em,{children:"Bottom line:"})," Containers and Conda have solved the nightmare of manual installs, making reproducible science and collaboration routine in bioinformatics."]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"2-using-docker-containers-for-bioinformatics-data-analysis",children:"2. Using Docker Containers for Bioinformatics Data Analysis"}),"\n",(0,s.jsx)(n.p,{children:"One of the biggest advantages of Docker is the ability to run bioinformatics tools directly\u2014without any installation\u2014on your own datasets. Here\u2019s a practical example using FastQC, a widely used quality control tool for sequencing data."}),"\n",(0,s.jsx)(n.h3,{id:"example-run-fastqc-from-a-container",children:"Example: Run FastQC from a Container"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Pull the FastQC container (only needed once):"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"docker pull quay.io/biocontainers/fastqc:<version>\n# Replace <version> with the specific tag, e.g. 0.11.9--hdfd78af_1\n"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Run FastQC, mounting your data folder:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'docker run --rm -v "$PWD:/data" quay.io/biocontainers/fastqc:<version> fastqc /data/my_reads.fastq\n'})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"--rm"}),": Automatically remove the container after it exits."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:'-v "$PWD:/data"'}),": Mount your current directory (with your FASTQ file) into the container at ",(0,s.jsx)(n.code,{children:"/data"}),"."]}),"\n",(0,s.jsx)(n.li,{children:"The container runs the FastQC executable, analyzing the file and writing results back to your folder."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Key Benefits:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"No software installation or dependency headaches."}),"\n",(0,s.jsx)(n.li,{children:"Exact version and environment guaranteed."}),"\n",(0,s.jsx)(n.li,{children:"Can share or rerun analysis anywhere Docker is available (Linux, Mac, Windows, cloud, HPC)."}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"This approach works for thousands of bioinformatics containers\u2014swap FastQC for Samtools, BWA, STAR, or other tools and run your analysis fully reproducibly and portable."}),"\n",(0,s.jsx)(n.h3,{id:"running-containers-interactively",children:"Running Containers Interactively"}),"\n",(0,s.jsxs)(n.p,{children:["Sometimes you want to run tools or explore interactively inside the container, just as if you were launching a shell. Docker makes this easy with the ",(0,s.jsx)(n.code,{children:"-it"})," flags:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"-i"})," keeps STDIN open (interactive input)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"-t"})," allocates a pseudo-terminal (TTY)"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Example: Start an interactive shell inside the FastQC container:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'docker run --rm -it -v "$PWD:/data" quay.io/biocontainers/fastqc:<version> /bin/bash\n'})}),"\n",(0,s.jsx)(n.p,{children:"Now you\u2019re inside the container shell:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"fastqc /data/my_reads.fastq\nls /data\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Benefits:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Inspect files, experiment with commands, or troubleshoot in real-time"}),"\n",(0,s.jsx)(n.li,{children:"Explore the container environment (dependencies, installed tools)"}),"\n",(0,s.jsx)(n.li,{children:"Still fully reproducible every time you launch"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"debugging-and-inspecting-a-running-docker-container",children:"Debugging and Inspecting a Running Docker Container"}),"\n",(0,s.jsxs)(n.p,{children:["If your container is already running (perhaps as part of a pipeline or a background process), Docker lets you connect and debug interactively using ",(0,s.jsx)(n.code,{children:"docker exec"}),":"]}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"List running containers:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"docker ps\n"})}),"\n",(0,s.jsx)(n.p,{children:"Note the CONTAINER ID in the output."}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Start a bash shell inside the running container:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"docker exec -it <CONTAINER_ID> /bin/bash\n"})}),"\n",(0,s.jsx)(n.p,{children:"Now you can inspect files, check logs, and run additional commands inside the live container."}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h3,{id:"entrypoint-and-overriding-commands",children:"ENTRYPOINT and Overriding Commands"}),"\n",(0,s.jsx)(n.p,{children:"Many containers run a specific tool as their default ENTRYPOINT\u2014for example, FastQC containers launch FastQC automatically. However, you can temporarily override ENTRYPOINT and start a shell using:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"docker run --rm -it --entrypoint /bin/bash quay.io/biocontainers/fastqc:<version>\n"})}),"\n",(0,s.jsx)(n.p,{children:"This starts an interactive shell even if the container\u2019s Dockerfile specifies a different default command. Useful for debugging, troubleshooting, or exploring the container environment."}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Summary:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Use ",(0,s.jsx)(n.code,{children:"docker exec"})," to debug running containers"]}),"\n",(0,s.jsx)(n.li,{children:"Override ENTRYPOINT for interactive shells"}),"\n",(0,s.jsx)(n.li,{children:"Enables real-time troubleshooting and inspection, making containers even more flexible for science"}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h3,{id:"running-containers-with-nextflow-inspecting-the-actual-docker-commands",children:"Running Containers with Nextflow: Inspecting the Actual Docker Commands"}),"\n",(0,s.jsx)(n.p,{children:"When you run a Nextflow pipeline with Docker containers, Nextflow automatically generates and executes Docker commands for each task. Understanding these commands is useful for debugging, profiling, and understanding exactly what your pipeline is doing."}),"\n",(0,s.jsx)(n.h4,{id:"where-nextflow-stores-docker-commands",children:"Where Nextflow Stores Docker Commands"}),"\n",(0,s.jsx)(n.p,{children:"Nextflow creates a work directory structure where each task has its own folder containing:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:".command.sh"})," - The shell script to execute"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:".command.run"})," - The wrapper script that Nextflow uses to run the task"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:".command.trace"})," - Task execution trace"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:".exitcode"})," - Exit code of the task"]}),"\n",(0,s.jsx)(n.li,{children:"Output files from the task"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Directory structure:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"work/\n\u251c\u2500\u2500 ab/\n\u2502   \u251c\u2500\u2500 abc123def456.../\n\u2502   \u2502   \u251c\u2500\u2500 .command.sh\n\u2502   \u2502   \u251c\u2500\u2500 .command.run\n\u2502   \u2502   \u251c\u2500\u2500 .command.trace\n\u2502   \u2502   \u2514\u2500\u2500 ... (output files)\n\u2502   \u2514\u2500\u2500 def789ghi012.../\n\u2502       \u2514\u2500\u2500 ...\n\u2514\u2500\u2500 fe/\n    \u2514\u2500\u2500 949a78b06c5fd8284aeb2f87d14f7d/\n        \u251c\u2500\u2500 .command.sh\n        \u251c\u2500\u2500 .command.run\n        \u2514\u2500\u2500 ... (task outputs)\n"})}),"\n",(0,s.jsx)(n.h4,{id:"viewing-the-actual-docker-command",children:"Viewing the Actual Docker Command"}),"\n",(0,s.jsx)(n.p,{children:"To see the exact Docker command that Nextflow executed for a specific task:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"# 1. Find your task's work directory\n# For example, in the pipeline output you might see:\n#   vep (ensembl-vep:115.2) [fe/949a78b...]\n\n# 2. Navigate to that directory\ncd work/fe/949a78b06c5fd8284aeb2f87d14f7d/\n\n# 3. View the command that was executed\ncat .command.run\n"})}),"\n",(0,s.jsx)(n.h4,{id:"example-nextflow-docker-command-for-vep-variant-effect-predictor",children:"Example: Nextflow Docker Command for VEP (Variant Effect Predictor)"}),"\n",(0,s.jsx)(n.p,{children:"Here's a complete example of how Nextflow runs a Docker container:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'docker rm $NXF_BOXID &>/dev/null || true\ndocker stop $NXF_BOXID\n\ndocker run -i \\\n  --cpu-shares 8192 \\\n  --memory 14336m \\\n  -e "NXF_TASK_WORKDIR" \\\n  -e "NXF_DEBUG=${NXF_DEBUG:=0}" \\\n  -v <your project working directory>:<your project working directory> \\\n  -w "$NXF_TASK_WORKDIR" \\\n  -u $(id -u):$(id -g) \\\n  --name $NXF_BOXID \\\n  community.wave.seqera.io/library/ensembl-vep:115.2--90ec797ecb088e9a \\\n  /bin/bash <your project working directory>/work/fe/949a78b06c5fd8284aeb2f87d14f7d/.command.run nxf_trace\n'})}),"\n",(0,s.jsx)(n.h4,{id:"breaking-down-the-docker-command",children:"Breaking Down the Docker Command"}),"\n",(0,s.jsx)(n.p,{children:"Let's understand each component:"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Component"}),(0,s.jsx)(n.th,{children:"Purpose"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"docker run"})}),(0,s.jsx)(n.td,{children:"Start a new container"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"-i"})}),(0,s.jsx)(n.td,{children:"Keep STDIN open (interactive)"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"--cpu-shares 8192"})}),(0,s.jsx)(n.td,{children:"Allocate CPU resources (set by Nextflow from cpus directive)"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"--memory 14336m"})}),(0,s.jsx)(n.td,{children:"Limit memory to 14GB (set by Nextflow from memory directive)"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"-e NXF_TASK_WORKDIR"})}),(0,s.jsx)(n.td,{children:"Pass Nextflow task work directory env var"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"-e NXF_DEBUG=${NXF_DEBUG:=0}"})}),(0,s.jsx)(n.td,{children:"Pass debug flag"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"-v /project:/project"})}),(0,s.jsx)(n.td,{children:"Mount project directory for input/output"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:'-w "$NXF_TASK_WORKDIR"'})}),(0,s.jsx)(n.td,{children:"Set working directory inside container"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"-u $(id -u):$(id -g)"})}),(0,s.jsx)(n.td,{children:"Run as current user (file permissions)"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"--name $NXF_BOXID"})}),(0,s.jsx)(n.td,{children:"Name the container (cleanup reference)"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"image:tag"})}),(0,s.jsx)(n.td,{children:"Container image to use"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"/bin/bash .command.run"})}),(0,s.jsx)(n.td,{children:"Execute the task script"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"nxf_trace"})}),(0,s.jsx)(n.td,{children:"Nextflow tracing flag"})]})]})]}),"\n",(0,s.jsx)(n.h4,{id:"re-running-a-failed-task-manually",children:"Re-Running a Failed Task Manually"}),"\n",(0,s.jsx)(n.p,{children:"If a task fails in Nextflow, you can manually re-run it for debugging:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'# 1. Navigate to the task work directory\ncd work/fe/949a78b06c5fd8284aeb2f87d14f7d/\n\n# 2. View the task script\ncat .command.sh\n\n# 3. View Nextflow\'s Docker wrapper\ncat .command.run\n\n# 4. Manually run the Docker command (copy from .command.run output)\n# and inspect what went wrong\ndocker run -i \\\n  --cpu-shares 8192 \\\n  --memory 14336m \\\n  -e "NXF_TASK_WORKDIR" \\\n  -v <your project working directory>:<your project working directory> \\\n  -w "$NXF_TASK_WORKDIR" \\\n  -u $(id -u):$(id -g) \\\n  community.wave.seqera.io/library/ensembl-vep:115.2--90ec797ecb088e9a \\\n  /bin/bash <your project working directory>/work/fe/949a78b06c5fd8284aeb2f87d14f7d/.command.run\n\n# 5. Check the exit code\ncat .exitcode\n\n# 6. View any error logs\ncat .command.err  # (if exists)\ncat .command.out  # (if exists)\n\n# 7. If you run on HPC, (e.g SLURM ), run submit job\nsbatch .command.run\n\n# 8. You can debug manually by running container interactively\ndocker run -it -v $PWD:$PWD -w $PWD <your container> \n\n# 9. Modify .command.sh then inside your container, start to debug by running command directly\nbash .command.sh\n'})}),"\n",(0,s.jsx)(n.h4,{id:"key-nextflow-docker-features",children:"Key Nextflow Docker Features"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Feature"}),(0,s.jsx)(n.th,{children:"How Nextflow Uses It"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Resource limits"})}),(0,s.jsxs)(n.td,{children:[(0,s.jsx)(n.code,{children:"--cpus"})," and ",(0,s.jsx)(n.code,{children:"--memory"})," directives \u2192 ",(0,s.jsx)(n.code,{children:"--cpu-shares"})," and ",(0,s.jsx)(n.code,{children:"--memory"})," flags"]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Volume mounts"})}),(0,s.jsxs)(n.td,{children:["Pipeline inputs/outputs \u2192 ",(0,s.jsx)(n.code,{children:"-v"})," flags"]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"User permissions"})}),(0,s.jsxs)(n.td,{children:["Current user \u2192 ",(0,s.jsx)(n.code,{children:"-u $(id -u):$(id -g)"})]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Work directory"})}),(0,s.jsxs)(n.td,{children:["Task-specific directory \u2192 ",(0,s.jsx)(n.code,{children:'-w "$NXF_TASK_WORKDIR"'})]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Container cleanup"})}),(0,s.jsxs)(n.td,{children:["Automatic removal \u2192 ",(0,s.jsx)(n.code,{children:"docker rm"})," commands"]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Environment variables"})}),(0,s.jsxs)(n.td,{children:["Pipeline configuration \u2192 ",(0,s.jsx)(n.code,{children:"-e"})," flags"]})]})]})]}),"\n",(0,s.jsx)(n.h4,{id:"profiling-and-optimization",children:"Profiling and Optimization"}),"\n",(0,s.jsx)(n.p,{children:"By examining the actual Docker commands, you can:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Check resource allocation:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'grep "cpu-shares\\|memory" work/*/*)/.command.run\n'})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Verify mounted volumes:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'grep "\\-v" work/ab/abc123*/.command.run\n'})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"See container images being used:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'grep "docker run" work/*/*)/.command.run | grep -oE "image:[^ ]+"\n'})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Profile task execution:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'# Check how long each task took\nfor dir in work/*/*/*/.command.trace; do\n    echo "Task: $(dirname $dir)"\n    cat "$dir"\ndone\n'})}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"summary",children:"Summary"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Nextflow automatically generates Docker commands for each task"}),"\n",(0,s.jsxs)(n.li,{children:["Task commands are stored in ",(0,s.jsx)(n.code,{children:"work/<task-id>/.command.run"})]}),"\n",(0,s.jsx)(n.li,{children:"You can inspect and manually re-run failed tasks"}),"\n",(0,s.jsx)(n.li,{children:"Understanding these commands helps with debugging and optimization"}),"\n",(0,s.jsx)(n.li,{children:"Resource limits from Nextflow directives are converted to Docker flags"}),"\n",(0,s.jsx)(n.li,{children:"Each task runs in isolation with its own work directory"}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"3-efficient-docker-container-building-for-bioinformatics",children:"3. Efficient Docker Container Building for Bioinformatics"}),"\n",(0,s.jsx)(n.p,{children:"Building efficient Docker containers keeps your images fast to download, runs, and easy to share."}),"\n",(0,s.jsx)(n.h3,{id:"best-practices",children:"Best Practices"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Start with a lightweight, official base image"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Alpine, Debian-slim, Ubuntu LTS"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Install only required tools"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Don't add extra utilities or unnecessary packages"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Clean cache and remove temp files"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["In the same RUN step: ",(0,s.jsx)(n.code,{children:"rm -rf /var/lib/apt/lists/*"})]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Use multi-stage builds for large or compiled tools"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Build from source in a builder stage, copy binaries into a slim final image"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"minimal-example-install-a-tool",children:"Minimal Example: Install a Tool"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-dockerfile",children:'FROM ubuntu:24.04\nRUN apt-get update && \\\n    apt-get install -y --no-install-recommends samtools && \\\n    apt-get clean && rm -rf /var/lib/apt/lists/*\nWORKDIR /data\nCMD ["/bin/bash"]\n'})}),"\n",(0,s.jsx)(n.h3,{id:"multi-stage-build-example-build-from-source",children:"Multi-Stage Build Example: Build from Source"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-dockerfile",children:'FROM ubuntu:24.04 AS builder\nRUN apt-get update && apt-get install -y build-essential wget\nRUN wget https://github.com/samtools/samtools/releases/download/1.18/samtools-1.18.tar.bz2 && \\\n    tar -xjf samtools-1.18.tar.bz2 && \\\n    cd samtools-1.18 && \\\n    ./configure --prefix=/usr/local && make && make install\n\nFROM ubuntu:24.04\nRUN apt-get update && apt-get install -y --no-install-recommends libbz2-1.0 liblzma5 zlib1g\nCOPY --from=builder /usr/local/bin/samtools /usr/local/bin/\nWORKDIR /data\nCMD ["/bin/bash"]\n'})}),"\n",(0,s.jsx)(n.h3,{id:"further-optimizations",children:"Further Optimizations"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Sort package lists alphabetically"}),"\n",(0,s.jsxs)(n.li,{children:["Use ",(0,s.jsx)(n.code,{children:".dockerignore"})," to reduce build context size"]}),"\n",(0,s.jsx)(n.li,{children:"Pin exact tool/package versions for reproducibility"}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"4-building-docker-images-with-conda-and-micromamba",children:"4. Building Docker Images with Conda and Micromamba"}),"\n",(0,s.jsx)(n.p,{children:"Building Docker containers from Conda packages is one of the most efficient ways to create reproducible bioinformatics environments. Micromamba is a lightweight, faster alternative to Conda that's perfect for containers."}),"\n",(0,s.jsx)(n.h3,{id:"why-micromamba-for-docker-images",children:"Why Micromamba for Docker Images?"}),"\n",(0,s.jsx)(n.p,{children:"Micromamba offers significant advantages over traditional Conda:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Fast:"})," 10-100x faster dependency resolution than Conda"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Lightweight:"})," Minimal footprint, perfect for containerized deployments"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Reproducible:"})," Environment lock files guarantee exact versions"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Production-ready:"})," Used extensively in bioinformatics pipelines"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Small base image:"})," Official ",(0,s.jsx)(n.code,{children:"mambaorg/micromamba"})," image is only ~150MB"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"the-modern-approach-condayml--micromamba",children:"The Modern Approach: Conda.yml + Micromamba"}),"\n",(0,s.jsxs)(n.p,{children:["Instead of writing complex RUN commands with inline package specifications, use a ",(0,s.jsx)(n.code,{children:"conda.yml"})," environment file:"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"conda.yml:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"name: base\nchannels:\n  - conda-forge\n  - bioconda\ndependencies:\n  - bioconda::fastqc=0.12.1\n  - bioconda::samtools=1.18\n  - bioconda::bwa=0.7.17\n  - conda-forge::procps-ng\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Dockerfile:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-dockerfile",children:'FROM mambaorg/micromamba:1.5.10-noble\n\n# Copy environment file\nCOPY --chown=$MAMBA_USER:$MAMBA_USER conda.yml /tmp/conda.yml\n\n# Install packages from environment file\nRUN micromamba install -y -n base -f /tmp/conda.yml \\\n    && micromamba clean -a -y\n\n# Export explicit lock file for reproducibility\nRUN micromamba env export --name base --explicit > environment.lock \\\n    && echo ">> CONDA_LOCK_START" \\\n    && cat environment.lock \\\n    && echo "<< CONDA_LOCK_END"\n\n# Set PATH\nUSER root\nENV PATH="$MAMBA_ROOT_PREFIX/bin:$PATH"\n\nWORKDIR /data\nCMD ["/bin/bash"]\n'})}),"\n",(0,s.jsx)(n.h3,{id:"understanding-the-dockerfile",children:"Understanding the Dockerfile"}),"\n",(0,s.jsx)(n.p,{children:"Let's break down each component:"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"1. Base Image:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-dockerfile",children:"FROM mambaorg/micromamba:1.5.10-noble\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"mambaorg/micromamba"})," includes Micromamba pre-installed"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"1.5.10"})," is the version (pin for reproducibility)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"noble"})," is Ubuntu 24.04 LTS variant"]}),"\n",(0,s.jsx)(n.li,{children:"Much lighter than installing Conda from scratch"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"2. Copy Environment File:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-dockerfile",children:"COPY --chown=$MAMBA_USER:$MAMBA_USER conda.yml /tmp/conda.yml\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Copies your conda.yml to the container"}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"$MAMBA_USER"})," is the non-root user (set by base image)"]}),"\n",(0,s.jsx)(n.li,{children:"Preserves proper file ownership"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"3. Install with Micromamba:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-dockerfile",children:"RUN micromamba install -y -n base -f /tmp/conda.yml \\\n    && micromamba clean -a -y\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"-y"}),": Auto-confirm installation"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"-n base"}),": Install into the base environment"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"-f /tmp/conda.yml"}),": Use environment file"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"micromamba clean -a -y"}),": Remove cached packages (reduces image size by ~50%)"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"4. Generate Lock File (for reproducibility):"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-dockerfile",children:'RUN micromamba env export --name base --explicit > environment.lock \\\n    && echo ">> CONDA_LOCK_START" \\\n    && cat environment.lock \\\n    && echo "<< CONDA_LOCK_END"\n'})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Exports explicit lock file with exact pinned versions and URLs"}),"\n",(0,s.jsx)(n.li,{children:"Echo statements make lock file visible in build logs"}),"\n",(0,s.jsx)(n.li,{children:"This file can be saved and used for exact reproducibility later"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"5. Set PATH and User:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-dockerfile",children:'USER root\nENV PATH="$MAMBA_ROOT_PREFIX/bin:$PATH"\n'})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Ensures Micromamba binaries are in PATH"}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"USER root"})," required for some system monitoring (see procps-ng below)"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"why-procps-ng-is-important-for-nextflow",children:"Why procps-ng is Important for Nextflow"}),"\n",(0,s.jsxs)(n.p,{children:["Notice ",(0,s.jsx)(n.code,{children:"conda-forge::procps-ng"})," in the dependencies. Here's why:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"dependencies:\n  - conda-forge::procps-ng\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Nextflow uses ",(0,s.jsx)(n.code,{children:"procps-ng"})," tools (like ",(0,s.jsx)(n.code,{children:"ps"}),", ",(0,s.jsx)(n.code,{children:"top"}),") to monitor:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"CPU usage"}),"\n",(0,s.jsx)(n.li,{children:"Memory consumption"}),"\n",(0,s.jsx)(n.li,{children:"Process status"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"Without it, Nextflow cannot properly track task resource usage. Always include it in bioinformatics containers."}),"\n",(0,s.jsx)(n.h3,{id:"complete-multi-tool-example",children:"Complete Multi-Tool Example"}),"\n",(0,s.jsx)(n.p,{children:"Here's a full example with multiple bioinformatics tools:"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"conda.yml:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"name: base\nchannels:\n  - conda-forge\n  - bioconda\ndependencies:\n  - bioconda::fastqc=0.12.1\n  - bioconda::samtools=1.18\n  - bioconda::bwa=0.7.17\n  - bioconda::bcftools=1.18\n  - bioconda::picard=3.0.0\n  - conda-forge::procps-ng\n  - conda-forge::parallel\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Dockerfile:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-dockerfile",children:'FROM mambaorg/micromamba:1.5.10-noble\n\nCOPY --chown=$MAMBA_USER:$MAMBA_USER conda.yml /tmp/conda.yml\n\nRUN micromamba install -y -n base -f /tmp/conda.yml \\\n    && micromamba install -y -n base conda-forge::procps-ng \\\n    && micromamba env export --name base --explicit > environment.lock \\\n    && echo ">> CONDA_LOCK_START" \\\n    && cat environment.lock \\\n    && echo "<< CONDA_LOCK_END" \\\n    && micromamba clean -a -y\n\nUSER root\nENV PATH="$MAMBA_ROOT_PREFIX/bin:$PATH"\n\nWORKDIR /data\nCMD ["/bin/bash"]\n'})}),"\n",(0,s.jsx)(n.h3,{id:"building-and-using-your-container",children:"Building and Using Your Container"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"1. Build the image:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"docker build -t myregistry.com/bioinformatics/biotools:1.0 .\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"2. Test it locally:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'docker run --rm -v "$PWD:/data" myregistry.com/bioinformatics/biotools:1.0 \\\n    fastqc /data/sample.fastq\n'})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"3. Push to registry:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"docker push myregistry.com/bioinformatics/biotools:1.0\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"4. Use in Nextflow:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-groovy",children:'process FASTQC {\n    tag "${meta.id}"\n    label \'process_medium\'\n\n    conda "${moduleDir}/environment.yml"\n    container "${ workflow.containerEngine == \'singularity\' && !task.ext.singularity_pull_docker_container ?\n        \'https://depot.galaxyproject.org/singularity/fastqc:0.12.1--hdfd78af_0\' :\n        \'biocontainers/fastqc:0.12.1--hdfd78af_0\' }"\n\n    input:\n    tuple val(meta), path(reads)\n\n    output:\n    tuple val(meta), path("*.html"), emit: html\n    tuple val(meta), path("*.zip") , emit: zip\n    path  "versions.yml"           , emit: versions\n\n    when:\n    task.ext.when == null || task.ext.when\n\n    script:\n    def args          = task.ext.args ?: \'\'\n    def prefix        = task.ext.prefix ?: "${meta.id}"\n    // Make list of old name and new name pairs to use for renaming in the bash while loop\n    def old_new_pairs = reads instanceof Path || reads.size() == 1 ? [[ reads, "${prefix}.${reads.extension}" ]] : reads.withIndex().collect { entry, index -> [ entry, "${prefix}_${index + 1}.${entry.extension}" ] }\n    def rename_to     = old_new_pairs*.join(\' \').join(\' \')\n    def renamed_files = old_new_pairs.collect{ _old_name, new_name -> new_name }.join(\' \')\n\n    // The total amount of allocated RAM by FastQC is equal to the number of threads defined (--threads) time the amount of RAM defined (--memory)\n    // https://github.com/s-andrews/FastQC/blob/1faeea0412093224d7f6a07f777fad60a5650795/fastqc#L211-L222\n    // Dividing the task.memory by task.cpu allows to stick to requested amount of RAM in the label\n    def memory_in_mb = task.memory ? task.memory.toUnit(\'MB\') / task.cpus : null\n    // FastQC memory value allowed range (100 - 10000)\n    def fastqc_memory = memory_in_mb > 10000 ? 10000 : (memory_in_mb < 100 ? 100 : memory_in_mb)\n\n    """\n    printf "%s %s\\\\n" ${rename_to} | while read old_name new_name; do\n        [ -f "\\${new_name}" ] || ln -s \\$old_name \\$new_name\n    done\n\n    fastqc \\\\\n        ${args} \\\\\n        --threads ${task.cpus} \\\\\n        --memory ${fastqc_memory} \\\\\n        ${renamed_files}\n\n    cat <<-END_VERSIONS > versions.yml\n    "${task.process}":\n        fastqc: \\$( fastqc --version | sed \'/FastQC v/!d; s/.*v//\' )\n    END_VERSIONS\n    """\n\n    stub:\n    def prefix = task.ext.prefix ?: "${meta.id}"\n    """\n    touch ${prefix}.html\n    touch ${prefix}.zip\n\n    cat <<-END_VERSIONS > versions.yml\n    "${task.process}":\n        fastqc: \\$( fastqc --version | sed \'/FastQC v/!d; s/.*v//\' )\n    END_VERSIONS\n    """\n}\n'})}),"\n",(0,s.jsx)(n.h3,{id:"advantages-of-this-approach",children:"Advantages of This Approach"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Feature"}),(0,s.jsx)(n.th,{children:"conda.yml + Micromamba"}),(0,s.jsx)(n.th,{children:"Traditional Conda Dockerfile"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Build speed"})}),(0,s.jsx)(n.td,{children:"Very fast (10-100x)"}),(0,s.jsx)(n.td,{children:"Slow"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Image size"})}),(0,s.jsx)(n.td,{children:"~200MB for tools"}),(0,s.jsx)(n.td,{children:"~1-2GB"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Reproducibility"})}),(0,s.jsx)(n.td,{children:"Explicit lock file"}),(0,s.jsx)(n.td,{children:"Dependency drift possible"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Version pinning"})}),(0,s.jsx)(n.td,{children:"Easy in YAML"}),(0,s.jsx)(n.td,{children:"Inline in Dockerfile"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Readability"})}),(0,s.jsx)(n.td,{children:"Clear, readable YAML"}),(0,s.jsx)(n.td,{children:"Complex RUN statements"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Channel support"})}),(0,s.jsx)(n.td,{children:"Multiple channels"}),(0,s.jsx)(n.td,{children:"Limited"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Maintenance"})}),(0,s.jsx)(n.td,{children:"Update conda.yml easily"}),(0,s.jsx)(n.td,{children:"Rebuild entire Dockerfile"})]})]})]}),"\n",(0,s.jsx)(n.h3,{id:"saving-and-sharing-explicit-lock-files",children:"Saving and Sharing Explicit Lock Files"}),"\n",(0,s.jsxs)(n.p,{children:["The generated ",(0,s.jsx)(n.code,{children:"environment.lock"})," file is extremely valuable. Save it in your project:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'# Extract from build output and save\ndocker build . 2>&1 | grep -A 1000 "CONDA_LOCK_START" | grep -B 1000 "CONDA_LOCK_END" > environment.lock\n'})}),"\n",(0,s.jsx)(n.p,{children:"Later, reproduce the exact environment:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"# Rebuild from locked versions\nmicromamba install -y -n base --file environment.lock\n"})}),"\n",(0,s.jsx)(n.h3,{id:"pixi-the-next-generation-tool-for-conda-based-containers",children:"Pixi: The Next Generation Tool for Conda-Based Containers"}),"\n",(0,s.jsx)(n.p,{children:"Pixi is an emerging tool that combines the best aspects of Conda, Mamba, and lock file management into a single, ultra-fast solution. It's gaining traction in bioinformatics for building reproducible containers."}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Why Pixi?"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Fastest:"})," Even faster than Micromamba for dependency resolution"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Automatic lock files:"})," Lock files are created automatically, no manual export needed"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Single-step reproducibility:"})," One tool handles everything from installation to reproducibility"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Cross-platform:"})," Works seamlessly across different architectures and systems"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Modern approach:"})," Designed from scratch with containerization in mind"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Example Dockerfile with Pixi:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-dockerfile",children:'ARG PIXI_VERSION=0.63.2\nARG BASE_IMAGE=debian:bookworm-slim\n\nFROM --platform=linux/amd64 ubuntu:24.04 AS builder\nARG PIXI_VERSION\nRUN apt-get update && apt-get install -y curl\nRUN curl -Ls \\\n    "https://github.com/prefix-dev/pixi/releases/download/v${PIXI_VERSION}/pixi-$(uname -m)-unknown-linux-musl" \\\n    -o /pixi && chmod +x /pixi\nRUN /pixi --version\n\nFROM --platform=linux/amd64 $BASE_IMAGE\n\n# Add appuser with UID 1000\nRUN useradd -u 1000 -m -s /bin/bash appuser\nUSER appuser\nWORKDIR /home/appuser\n\n# Copy pixi from builder\nCOPY --from=builder --chown=appuser:appuser --chmod=0555 /pixi /usr/local/bin/pixi\n\n# Set up pixi with conda channels\nENV PATH="/home/appuser/.pixi/bin:${PATH}"\nRUN pixi config set default-channels \'["conda-forge", "bioconda"]\' --global\n\n# Install tools using pixi\nRUN pixi global install fastqc=0.12.1 samtools=1.18 bwa=0.7.17\n\n# Clean cache\nRUN pixi clean cache -y\n\nWORKDIR /data\nCMD ["/bin/bash"]\n'})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Key Pixi Features in the Dockerfile:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Multi-stage build:"})," Builder stage compiles Pixi, final stage is lean"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"User management:"})," Non-root appuser for security"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Global channel setup:"})," Pre-configures conda-forge and bioconda channels"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Direct package installation:"})," ",(0,s.jsx)(n.code,{children:"pixi global install"})," installs and locks versions automatically"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Automatic lock file:"})," Lock file is generated implicitly, ensuring reproducibility"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Cache cleaning:"})," ",(0,s.jsx)(n.code,{children:"pixi clean cache -y"})," removes temporary files"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Comparing Container Tools:"})}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Feature"}),(0,s.jsx)(n.th,{children:"Conda"}),(0,s.jsx)(n.th,{children:"Micromamba"}),(0,s.jsx)(n.th,{children:"Pixi"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Speed"})}),(0,s.jsx)(n.td,{children:"Slow (baseline)"}),(0,s.jsx)(n.td,{children:"10-100x faster"}),(0,s.jsx)(n.td,{children:"100x+ faster"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Lock file"})}),(0,s.jsx)(n.td,{children:"Manual export"}),(0,s.jsx)(n.td,{children:"Manual export"}),(0,s.jsx)(n.td,{children:"Automatic"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Image size"})}),(0,s.jsx)(n.td,{children:"Large"}),(0,s.jsx)(n.td,{children:"Small"}),(0,s.jsx)(n.td,{children:"Small"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Reproducibility"})}),(0,s.jsx)(n.td,{children:"Good"}),(0,s.jsx)(n.td,{children:"Excellent"}),(0,s.jsx)(n.td,{children:"Excellent"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Complexity"})}),(0,s.jsx)(n.td,{children:"High"}),(0,s.jsx)(n.td,{children:"Medium"}),(0,s.jsx)(n.td,{children:"Low"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Learning curve"})}),(0,s.jsx)(n.td,{children:"Steep"}),(0,s.jsx)(n.td,{children:"Medium"}),(0,s.jsx)(n.td,{children:"Low"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Production-ready"})}),(0,s.jsx)(n.td,{children:"Yes"}),(0,s.jsx)(n.td,{children:"Yes"}),(0,s.jsx)(n.td,{children:"Emerging"})]})]})]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Summary:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Use ",(0,s.jsx)(n.code,{children:"conda.yml"})," with Micromamba for established, proven workflows"]}),"\n",(0,s.jsx)(n.li,{children:"Use Pixi for cutting-edge projects requiring maximum speed and simplicity"}),"\n",(0,s.jsxs)(n.li,{children:["Always include ",(0,s.jsx)(n.code,{children:"procps-ng"})," for Nextflow compatibility (regardless of tool)"]}),"\n",(0,s.jsx)(n.li,{children:"Generate/maintain explicit lock files for reproducibility"}),"\n",(0,s.jsx)(n.li,{children:"Pin exact versions to prevent dependency drift"}),"\n",(0,s.jsx)(n.li,{children:"Multi-channel support (conda-forge + bioconda) handles complex dependencies"}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"5-finding-pre-built-containers-before-building-from-scratch",children:"5. Finding Pre-Built Containers: Before Building from Scratch"}),"\n",(0,s.jsxs)(n.p,{children:["Before you spend time building Docker images from scratch, check if your tool already exists in a public container registry. Most bioinformatics tools have pre-built, maintained containers ready to use. This is the ",(0,s.jsx)(n.strong,{children:"fastest and easiest approach"})," when available."]}),"\n",(0,s.jsx)(n.h3,{id:"the-container-search-strategy",children:"The Container Search Strategy"}),"\n",(0,s.jsx)(n.p,{children:"Always follow this order:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Check BioContainers"})," (",(0,s.jsx)(n.a,{href:"https://biocontainers.pro/registry",children:"https://biocontainers.pro/registry"}),") - Most comprehensive bioinformatics registry"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Check Seqera Containers"})," (",(0,s.jsx)(n.a,{href:"https://seqera.io/containers/",children:"https://seqera.io/containers/"}),") - Multi-tool combinations, modern builds"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Build yourself"})," - Only if tool doesn't exist"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"1-biocontainers-primary-source",children:"1. BioContainers (Primary Source)"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"BioContainers"})," automatically builds and maintains Docker containers for every bioconda package. This is the most comprehensive source for bioinformatics tools."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"URL:"})," ",(0,s.jsx)(n.a,{href:"https://biocontainers.pro/registry",children:"https://biocontainers.pro/registry"})]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"How to find and use a tool:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'# Search for FastQC\ndocker search quay.io/biocontainers/fastqc\n\n# Pull a specific version\ndocker pull quay.io/biocontainers/fastqc:0.12.1--hdfd78af_1\n\n# Run the tool\ndocker run --rm -v "$PWD:/data" quay.io/biocontainers/fastqc:0.12.1--hdfd78af_1 \\\n    fastqc /data/sample.fastq\n'})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"biocontainer",src:i(94163).A+"",width:"2546",height:"1494"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Advantages:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u2705 Automatically updated when bioconda packages update"}),"\n",(0,s.jsx)(n.li,{children:"\u2705 Single-tool containers (clean, minimal)"}),"\n",(0,s.jsx)(n.li,{children:"\u2705 Stable and widely tested"}),"\n",(0,s.jsx)(n.li,{children:"\u2705 Available for most bioinformatics tools (~10,000+)"}),"\n",(0,s.jsx)(n.li,{children:"\u2705 Free and publicly accessible"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Limitations:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"One tool per image (no multi-tool combinations)"}),"\n",(0,s.jsx)(n.li,{children:"Must manually orchestrate multiple containers for pipelines"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Example with multiple tools in a workflow:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'# Align reads with BWA\ndocker run --rm -v "$PWD:/data" quay.io/biocontainers/bwa:0.7.17--h5bf99c6_8 \\\n    bwa mem /data/ref.fa /data/reads.fq > /data/aligned.sam\n\n# Sort BAM with Samtools\ndocker run --rm -v "$PWD:/data" quay.io/biocontainers/samtools:1.18--hd87286a_0 \\\n    samtools sort /data/aligned.sam > /data/aligned.bam\n'})}),"\n",(0,s.jsx)(n.h3,{id:"2-seqera-containers-also-support-multi-tool-option",children:"2. Seqera Containers (Also support Multi-Tool Option)"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Seqera Containers"})," provides a registry of pre-built containers that often combine multiple tools, perfect for complex workflows."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"URL:"})," ",(0,s.jsx)(n.a,{href:"https://seqera.io/containers/",children:"https://seqera.io/containers/"})]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"How to find and use containers:"})}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["Visit ",(0,s.jsx)(n.a,{href:"https://seqera.io/containers/",children:"https://seqera.io/containers/"})]}),"\n",(0,s.jsx)(n.li,{children:"Search for your tool(s)"}),"\n",(0,s.jsxs)(n.li,{children:["Add multiple tools if needed (e.g., ",(0,s.jsx)(n.code,{children:"fastqc"})," + ",(0,s.jsx)(n.code,{children:"samtools"})," together)"]}),"\n",(0,s.jsx)(n.li,{children:"Select your architecture (linux/amd64 or linux/arm64)"}),"\n",(0,s.jsx)(n.li,{children:"Get the container reference"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Example:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"# Pull a multi-tool container\ndocker pull wave.seqera.io/library/fastqc:0.12.1-samtools_1.18\n\n# Or use in Nextflow\nprocess analyzeReads {\n    container 'wave.seqera.io/library/fastqc:0.12.1-samtools_1.18'\n    script:\n    '''\n    fastqc input.fastq\n    samtools view input.bam\n    '''\n}\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.img,{alt:"seqera_container",src:i(42857).A+"",width:"2546",height:"1494"}),"\n",(0,s.jsx)(n.strong,{children:"Advantages:"})]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u2705 Combines multiple tools in one image"}),"\n",(0,s.jsx)(n.li,{children:"\u2705 Modern infrastructure"}),"\n",(0,s.jsx)(n.li,{children:"\u2705 Web interface for easy discovery"}),"\n",(0,s.jsx)(n.li,{children:"\u2705 Automatic lock file generation"}),"\n",(0,s.jsx)(n.li,{children:"\u2705 Multi-architecture support"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Limitations:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Fewer pre-built combinations than BioContainers"}),"\n",(0,s.jsx)(n.li,{children:"Relies on Seqera infrastructure"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"3-when-to-build-from-scratch",children:"3. When to Build from Scratch"}),"\n",(0,s.jsx)(n.p,{children:"Only build your own container if:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Tool doesn't exist"})," in any public registry"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Version not available"})," and you need an older/newer version"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Custom modifications"})," required (additional dependencies, scripts)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Performance optimizations"})," needed for specific hardware"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Example scenario:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"# Check if tool exists\ndocker pull quay.io/biocontainers/myraretool:latest  # \u274c Not found\n\n# Check Seqera Containers\n# Visit https://seqera.io/containers/ - (tool not found)\n\n# \u2192 NOW you build it yourself using Section 4 approach\ndocker build -t myregistry.com/myraretool:1.0 .\ndocker push myregistry.com/myraretool:1.0\n"})}),"\n",(0,s.jsx)(n.h3,{id:"quick-reference-where-to-find-each-tool",children:"Quick Reference: Where to Find Each Tool"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Tool Type"}),(0,s.jsx)(n.th,{children:"Primary Location"}),(0,s.jsx)(n.th,{children:"Alternative"}),(0,s.jsx)(n.th,{children:"Fallback"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsxs)(n.td,{children:[(0,s.jsx)(n.strong,{children:"Common bioinformatics"})," (FastQC, SAMtools, BWA, etc.)"]}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.a,{href:"https://biocontainers.pro/registry",children:"https://biocontainers.pro/registry"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.a,{href:"https://seqera.io/containers/",children:"https://seqera.io/containers/"})}),(0,s.jsx)(n.td,{children:"Build yourself"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"R/Bioconductor packages"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.a,{href:"https://biocontainers.pro/registry",children:"https://biocontainers.pro/registry"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.a,{href:"https://seqera.io/containers/",children:"https://seqera.io/containers/"})}),(0,s.jsx)(n.td,{children:"Build yourself"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Python bioinformatics"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.a,{href:"https://biocontainers.pro/registry",children:"https://biocontainers.pro/registry"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.a,{href:"https://seqera.io/containers/",children:"https://seqera.io/containers/"})}),(0,s.jsx)(n.td,{children:"Build yourself"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Specialized tools"})}),(0,s.jsxs)(n.td,{children:[(0,s.jsx)(n.a,{href:"https://biocontainers.pro/registry",children:"https://biocontainers.pro/registry"})," first"]}),(0,s.jsx)(n.td,{children:"GitHub releases"}),(0,s.jsx)(n.td,{children:"Build yourself"})]})]})]}),"\n",(0,s.jsx)(n.h3,{id:"practical-workflow-search--pull--use",children:"Practical Workflow: Search \u2192 Pull \u2192 Use"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'#!/bin/bash\n# 1. Search for tool in BioContainers\nTOOL="fastqc"\nVERSION="0.12.1"\necho "Searching for $TOOL:$VERSION in BioContainers..."\ndocker pull quay.io/biocontainers/$TOOL:$VERSION--* 2>/dev/null && \\\n    echo "\u2713 Found in BioContainers!" && \\\n    exit 0\n\n# 2. Try Seqera Containers\necho "Trying Seqera Containers..."\n# (Check https://seqera.io/containers/ manually or via API)\n\n# 3. Build yourself\necho "\u2717 Not found in public registries. Building from scratch..."\n# Use Section 4 approach with Micromamba or Pixi\ndocker build -t myregistry.com/$TOOL:$VERSION .\n'})}),"\n",(0,s.jsx)(n.h3,{id:"best-practices-for-using-pre-built-containers",children:"Best Practices for Using Pre-Built Containers"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Pin exact versions:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"\u2713 Good: docker pull quay.io/biocontainers/samtools:1.18--hd87286a_0\n\u2717 Bad:  docker pull quay.io/biocontainers/samtools:latest\n"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Check build hash in Nextflow:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-groovy",children:"process myTask {\n    // Include digest for reproducibility\n    container 'quay.io/biocontainers/samtools:1.18--hd87286a_0@sha256:abc123...'\n    script: 'samtools view input.bam'\n}\n"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Keep local cache for offline work:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"docker pull quay.io/biocontainers/samtools:1.18--hd87286a_0\ndocker tag quay.io/biocontainers/samtools:1.18--hd87286a_0 \\\n    myregistry.com/samtools:1.18\ndocker push myregistry.com/samtools:1.18\n"})}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"summary-container-registry-decision-tree",children:"Summary: Container Registry Decision Tree"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"Do you need a bioinformatics tool in a container?\n\u2502\n\u251c\u2500\u2192 Search https://biocontainers.pro/registry (BioContainers)\n\u2502   \u251c\u2500\u2192 Found? Use it \u2713\n\u2502   \u2514\u2500\u2192 Not found?\n\u2502       \u2502\n\u2502       \u251c\u2500\u2192 Search https://seqera.io/containers/ (Seqera Containers)\n\u2502       \u2502   \u251c\u2500\u2192 Found? Use it \u2713\n\u2502       \u2502   \u2514\u2500\u2192 Not found?\n\u2502       \u2502       \u2502\n\u2502       \u2502       \u2514\u2500\u2192 Build using Section 4\n\u2502       \u2502           (Micromamba or Pixi) \u2713\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Key Takeaway:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Check existing registries first"})," - saves time and uses community-maintained containers"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsxs)(n.strong,{children:["BioContainers (",(0,s.jsx)(n.a,{href:"https://biocontainers.pro/registry",children:"https://biocontainers.pro/registry"}),") is your first stop"]})," - most comprehensive bioinformatics registry"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsxs)(n.strong,{children:["Seqera (",(0,s.jsx)(n.a,{href:"https://seqera.io/containers/",children:"https://seqera.io/containers/"}),") for multi-tool combinations"]})," - modern approach for complex workflows"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Build yourself only as last resort"})," - but you now have the tools (Section 4) to do it well"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},29831(e,n,i){i.d(n,{A:()=>r});const r=i.p+"assets/images/intro-7aaa912f8e48c1bb524eacaf56d8a3cd.png"},94163(e,n,i){i.d(n,{A:()=>r});const r=i.p+"assets/images/biocontainer_container_registry-72da3ed4ec61f7ab5f175373cd1b0208.png"},42857(e,n,i){i.d(n,{A:()=>r});const r=i.p+"assets/images/seqera_container_registry-12220fdc32c49ac10d1a2a5ac24b2b8f.png"},28453(e,n,i){i.d(n,{R:()=>t,x:()=>l});var r=i(96540);const s={},o=r.createContext(s);function t(e){const n=r.useContext(o);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:t(e.components),r.createElement(o.Provider,{value:n},e.children)}},43397(e){e.exports=JSON.parse('{"permalink":"/river-docs/blog/bioinformatics-containers-build-efficient-docker","source":"@site/blog/2026-02/2026-02-08.md","title":"Containers in Bioinformatics: Community Tooling and Efficient Docker Building","description":"Docker containers are revolutionizing bioinformatics by automating reproducibility and portability across platforms. But what problems can they actually solve? This post shows real-world applications of containers in bioinformatics workflows, then guides you through the simplest possible ways to use, build and debug them.","date":"2026-02-08T00:00:00.000Z","tags":[{"inline":true,"label":"docker","permalink":"/river-docs/blog/tags/docker"},{"inline":true,"label":"bioinformatics","permalink":"/river-docs/blog/tags/bioinformatics"},{"inline":true,"label":"bioconda","permalink":"/river-docs/blog/tags/bioconda"},{"inline":true,"label":"nextflow","permalink":"/river-docs/blog/tags/nextflow"},{"inline":true,"label":"best-practices","permalink":"/river-docs/blog/tags/best-practices"}],"readingTime":20.67,"hasTruncateMarker":true,"authors":[{"name":"Thanh-Giang Tan Nguyen","title":"Founder at RIVER","url":"https://www.facebook.com/nttg8100","page":{"permalink":"/river-docs/blog/authors/river"},"email":"nttg8100@gmail.com","socials":{"linkedin":"https://www.linkedin.com/in/thanh-giang-tan-nguyen-761b28190/","github":"https://github.com/nttg8100"},"imageURL":"https://avatars.githubusercontent.com/u/64969412?v=4","key":"river"}],"frontMatter":{"slug":"bioinformatics-containers-build-efficient-docker","title":"Containers in Bioinformatics: Community Tooling and Efficient Docker Building","authors":["river"],"tags":["docker","bioinformatics","bioconda","nextflow","best-practices"],"image":"./imgs/intro.png"},"unlisted":false,"prevItem":{"title":"Containers in Bioinformatics: Community Tooling and Efficient Docker Building","permalink":"/river-docs/blog/bioinformatics-containers-build-efficient-docker"},"nextItem":{"title":"Bioinformatics Workflow Template: Standardizing Python Pipelines with Modular Design","permalink":"/river-docs/blog/bioinformatics-workflow-template-ci-cd-best-practices"}}')}}]);