"use strict";(globalThis.webpackChunkmy_website=globalThis.webpackChunkmy_website||[]).push([[3799],{2354(e,n,r){r.r(n),r.d(n,{assets:()=>c,contentTitle:()=>a,default:()=>u,frontMatter:()=>t,metadata:()=>o,toc:()=>l});var o=r(7287),s=r(4848),i=r(8453);const t={slug:"docker-out-docker-bioinformatics-web-apps",title:"Docker Out of Docker: Running Interactive Web Applications for Data Analysis",authors:["river"],tags:["docker","containers","rstudio","jupyterlab","code-server","bioinformatics","reproducibility","web-apps"],image:"./imgs/intro.png"},a=void 0,c={image:r(9831).A,authorsImageUrls:[void 0]},l=[{value:"1. The Scenario: Web Applications That Need to Run Containers",id:"1-the-scenario-web-applications-that-need-to-run-containers",level:2},{value:"1.1. Common Use Cases in Bioinformatics",id:"11-common-use-cases-in-bioinformatics",level:3},{value:"1.2. Why DooD Is Perfect for Web Applications",id:"12-why-dood-is-perfect-for-web-applications",level:3},{value:"2. Understanding Docker Out of Docker (DooD)",id:"2-understanding-docker-out-of-docker-dood",level:2},{value:"2.1. How DooD Works",id:"21-how-dood-works",level:3},{value:"2.2. Why This Works So Well",id:"22-why-this-works-so-well",level:3},{value:"3. Setting Up RStudio with DooD",id:"3-setting-up-rstudio-with-dood",level:2},{value:"3.1. Running RStudio with Docker Socket Mount",id:"31-running-rstudio-with-docker-socket-mount",level:3},{value:"3.2. Using Docker from Within RStudio",id:"32-using-docker-from-within-rstudio",level:3},{value:"3.3. Docker Compose Configuration for RStudio",id:"33-docker-compose-configuration-for-rstudio",level:3},{value:"4. Setting Up JupyterLab with DooD",id:"4-setting-up-jupyterlab-with-dood",level:2},{value:"4.1. Running JupyterLab with Docker Socket Mount",id:"41-running-jupyterlab-with-docker-socket-mount",level:3},{value:"4.2. Using Docker from JupyterLab Notebooks",id:"42-using-docker-from-jupyterlab-notebooks",level:3},{value:"4.3. Docker Compose Configuration for JupyterLab",id:"43-docker-compose-configuration-for-jupyterlab",level:3},{value:"5. Setting Up Code Server with DooD",id:"5-setting-up-code-server-with-dood",level:2},{value:"5.1. Running Code Server with Docker Socket Mount",id:"51-running-code-server-with-docker-socket-mount",level:3},{value:"5.2. Using Docker from Code Server",id:"52-using-docker-from-code-server",level:3},{value:"5.3. Docker Compose Configuration for Code Server",id:"53-docker-compose-configuration-for-code-server",level:3},{value:"6. Complete Multi-App Setup with Docker Compose",id:"6-complete-multi-app-setup-with-docker-compose",level:2},{value:"7. Important Considerations for DooD",id:"7-important-considerations-for-dood",level:2},{value:"7.1. Security Considerations",id:"71-security-considerations",level:3},{value:"7.2. Resource Management",id:"72-resource-management",level:3},{value:"7.3. Volume Management",id:"73-volume-management",level:3},{value:"8. Troubleshooting",id:"8-troubleshooting",level:2},{value:"8.1. Docker Socket Permission Denied",id:"81-docker-socket-permission-denied",level:3},{value:"8.2. File Permission Issues",id:"82-file-permission-issues",level:3},{value:"8.3. Volume Mount Not Visible",id:"83-volume-mount-not-visible",level:3},{value:"9. Summary",id:"9-summary",level:2}];function d(e){const n={a:"a",code:"code",h2:"h2",h3:"h3",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(n.p,{children:["Running interactive web applications like RStudio, JupyterLab, and Code Server in containers is a powerful way to provide reproducible analysis environments. However, users often need to spawn additional containerized tools from within these applications. ",(0,s.jsx)(n.strong,{children:"Docker out of Docker (DooD)"})," elegantly solves this by allowing containers to access the host's Docker daemon. This post explains how to set up DooD for interactive web applications and why it's the right approach for bioinformatics workflows."]}),"\n",(0,s.jsx)(n.h2,{id:"1-the-scenario-web-applications-that-need-to-run-containers",children:"1. The Scenario: Web Applications That Need to Run Containers"}),"\n",(0,s.jsx)(n.h3,{id:"11-common-use-cases-in-bioinformatics",children:"1.1. Common Use Cases in Bioinformatics"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"RStudio Server with Containerized Tools"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:'User opens RStudio in browser\n    \u2193\nInside RStudio, run: system("docker run quay.io/biocontainers/samtools:latest samtools ...")\n    \u2193\nNeeds access to host Docker daemon\n'})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"JupyterLab with Cell Ranger Analysis"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"User runs notebook cell with: !docker run cellranger:v7.0 cellranger count ...\n    \u2193\nNeeds Docker access from within JupyterLab container\n    \u2193\nResults written back to shared volume\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Code Server for Pipeline Development"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"User edits Nextflow script in Code Server\n    \u2193\nRuns: docker exec to test containerized tools locally\n    \u2193\nNeeds full Docker CLI access\n"})}),"\n",(0,s.jsx)(n.h3,{id:"12-why-dood-is-perfect-for-web-applications",children:"1.2. Why DooD Is Perfect for Web Applications"}),"\n",(0,s.jsx)(n.p,{children:"Web applications like RStudio, JupyterLab, and Code Server need to:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Run in a container"})," for reproducibility and dependency isolation"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Access Docker"})," to spawn containerized bioinformatics tools"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Share data volumes"})," with host and spawned containers"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Maintain file permissions"})," so users can access results"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"DooD provides all of this with a simple socket mount."}),"\n",(0,s.jsx)(n.h2,{id:"2-understanding-docker-out-of-docker-dood",children:"2. Understanding Docker Out of Docker (DooD)"}),"\n",(0,s.jsx)(n.h3,{id:"21-how-dood-works",children:"2.1. How DooD Works"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"DooD"})," mounts the host's Docker socket (",(0,s.jsx)(n.code,{children:"/var/run/docker.sock"}),") into the container. This allows processes inside the container to communicate directly with the ",(0,s.jsx)(n.strong,{children:"host's Docker daemon"}),"."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Key insight:"})," Containers spawned from within the DooD container appear as ",(0,s.jsx)(n.strong,{children:"siblings"})," to the web application container, not children. They run directly on the host, giving them full access to host resources and volumes."]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Architecture:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"Host System\n\u251c\u2500\u2500 Docker Daemon (listening on /var/run/docker.sock)\n\u251c\u2500\u2500 Host volumes (/data, /workspace)\n\u2502\n\u2514\u2500\u2500 Web App Container (RStudio/JupyterLab/Code Server)\n    \u251c\u2500\u2500 Mounts: /var/run/docker.sock:/var/run/docker.sock\n    \u251c\u2500\u2500 Mounts: /data:/data, /workspace:/workspace\n    \u2502\n    \u251c\u2500\u2500 User runs: docker run quay.io/biocontainers/bwa:latest ...\n    \u2502\n    \u2514\u2500\u2500 \u2192 Uses HOST Docker daemon to spawn sibling container\n        \u2192 Spawned container has full access to host volumes\n        \u2192 Results written back to shared volume\n        \u2192 Web app container can access results\n"})}),"\n",(0,s.jsx)(n.h3,{id:"22-why-this-works-so-well",children:"2.2. Why This Works So Well"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"No Resource Overhead"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"No nested Docker daemon"}),"\n",(0,s.jsx)(n.li,{children:"Minimal memory/CPU overhead"}),"\n",(0,s.jsx)(n.li,{children:"Fast container spawning (~100ms)"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Simple Volume Sharing"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Both web app and spawned containers can read/write shared volumes"}),"\n",(0,s.jsx)(n.li,{children:"No complex mount layering"}),"\n",(0,s.jsx)(n.li,{children:"Direct access to host filesystem"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Full Docker Access"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"docker ps, docker pull, docker build all work"}),"\n",(0,s.jsx)(n.li,{children:"Can manage images and containers from within the web app"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"3-setting-up-rstudio-with-dood",children:"3. Setting Up RStudio with DooD"}),"\n",(0,s.jsx)(n.h3,{id:"31-running-rstudio-with-docker-socket-mount",children:"3.1. Running RStudio with Docker Socket Mount"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Basic RStudio with DooD:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"#!/bin/bash\ndocker run \\\n  --rm \\\n  -p 8787:8787 \\\n  -e PASSWORD=mypassword \\\n  -v /var/run/docker.sock:/var/run/docker.sock \\\n  -v /home/user/data:/data \\\n  -v /home/user/workspace:/workspace \\\n  rocker/tidyverse:latest\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Explanation:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"-p 8787:8787"}),": RStudio web interface on port 8787"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"-e PASSWORD=mypassword"}),": Set RStudio password"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"-v /var/run/docker.sock:/var/run/docker.sock"}),": Mount Docker socket (enables DooD)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"-v /home/user/data:/data"}),": Share data directory"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"-v /home/user/workspace:/workspace"}),": Share workspace directory"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"32-using-docker-from-within-rstudio",children:"3.2. Using Docker from Within RStudio"}),"\n",(0,s.jsx)(n.p,{children:"Once RStudio is running, you can use Docker directly from the R console or shell:"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Running samtools from RStudio:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-r",children:"# In RStudio console\nsystem('docker run --rm -v /data:/data quay.io/biocontainers/samtools:latest samtools view -h /data/input.bam | head')\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Running bwa alignment:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-r",children:"# Run bwa in Docker container\ncmd <- 'docker run --rm -v /data:/data -v /workspace:/workspace quay.io/biocontainers/bwa:latest bwa mem /data/ref.fa /data/reads.fastq > /workspace/aligned.sam'\nsystem(cmd)\n\n# Read results back into R\nalignment <- read.table('/workspace/aligned.sam', skip=10)\nhead(alignment)\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Running Cell Ranger from RStudio:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-r",children:"# In RStudio terminal or system()\nsystem('\ndocker run --rm \\\\\n  -v /var/run/docker.sock:/var/run/docker.sock \\\\\n  -v /data:/data \\\\\n  cellranger:v7.0 \\\\\n  cellranger count \\\\\n    --id=sample1 \\\\\n    --fastqs=/data/fastqs \\\\\n    --transcriptome=/data/reference\n')\n\n# Load results\nlibrary(Seurat)\ndata <- Read10X_h5('/data/sample1/outs/filtered_feature_bc_matrix.h5')\n"})}),"\n",(0,s.jsx)(n.h3,{id:"33-docker-compose-configuration-for-rstudio",children:"3.3. Docker Compose Configuration for RStudio"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"More production-ready setup with docker-compose:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"version: '3.8'\n\nservices:\n  rstudio:\n    image: rocker/tidyverse:4.3.0\n    container_name: rstudio-analysis\n    ports:\n      - \"8787:8787\"\n    environment:\n      - PASSWORD=secure_password\n      - USER=researcher\n    volumes:\n      # Mount Docker socket for DooD\n      - /var/run/docker.sock:/var/run/docker.sock\n      # Mount data directories\n      - ./data:/data:rw\n      - ./workspace:/workspace:rw\n      - ./projects:/home/rstudio/projects:rw\n    restart: unless-stopped\n    # Optional: limit resources\n    deploy:\n      resources:\n        limits:\n          cpus: '4'\n          memory: 16G\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Run with:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"docker-compose up -d\n# Access at http://localhost:8787\n# Username: researcher\n# Password: secure_password\n"})}),"\n",(0,s.jsx)(n.h2,{id:"4-setting-up-jupyterlab-with-dood",children:"4. Setting Up JupyterLab with DooD"}),"\n",(0,s.jsx)(n.h3,{id:"41-running-jupyterlab-with-docker-socket-mount",children:"4.1. Running JupyterLab with Docker Socket Mount"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Basic JupyterLab with DooD:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"#!/bin/bash\ndocker run \\\n  --rm \\\n  -p 8888:8888 \\\n  -v /var/run/docker.sock:/var/run/docker.sock \\\n  -v /home/user/data:/data \\\n  -v /home/user/notebooks:/notebooks \\\n  jupyter/scipy-notebook:latest \\\n  jupyter lab --ip=0.0.0.0 --allow-root --no-browser\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Get the token from logs:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"# Output will show: http://127.0.0.1:8888/lab?token=xxxxx\n# Use that to access JupyterLab in browser\n"})}),"\n",(0,s.jsx)(n.h3,{id:"42-using-docker-from-jupyterlab-notebooks",children:"4.2. Using Docker from JupyterLab Notebooks"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Running bioinformatics tools in notebook cells:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"# In JupyterLab cell - run samtools in Docker\nimport subprocess\n\nresult = subprocess.run([\n    'docker', 'run', '--rm',\n    '-v', '/data:/data',\n    'quay.io/biocontainers/samtools:latest',\n    'samtools', 'view', '-h', '/data/input.bam'\n], capture_output=True, text=True)\n\nprint(result.stdout)\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Processing with Docker + Python integration:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"# Cell 1: Run analysis in container\nimport subprocess\nimport json\n\n# Run Cell Ranger in Docker\nsubprocess.run([\n    'docker', 'run', '--rm',\n    '-v', '/data:/data',\n    'cellranger:v7.0',\n    'cellranger', 'count',\n    '--id=sample1',\n    '--fastqs=/data/fastqs',\n    '--transcriptome=/data/reference'\n])\n\n# Cell 2: Load results in Python\nimport scanpy as sc\n\nadata = sc.read_h5ad('/data/sample1/outs/filtered_feature_bc_matrix.h5')\nprint(adata)\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Running FastQC on multiple samples:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"import subprocess\nimport os\nfrom pathlib import Path\n\nfastq_dir = '/data/fastqs'\n\n# Run FastQC on all FASTQ files\nfor fastq_file in Path(fastq_dir).glob('*.fastq.gz'):\n    subprocess.run([\n        'docker', 'run', '--rm',\n        '-v', '/data:/data',\n        'quay.io/biocontainers/fastqc:latest',\n        'fastqc',\n        f'/data/fastqs/{fastq_file.name}',\n        '-o', '/data/qc_results'\n    ])\n\nprint(\"FastQC analysis complete\")\n"})}),"\n",(0,s.jsx)(n.h3,{id:"43-docker-compose-configuration-for-jupyterlab",children:"4.3. Docker Compose Configuration for JupyterLab"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"version: '3.8'\n\nservices:\n  jupyter:\n    image: jupyter/scipy-notebook:latest\n    container_name: jupyterlab-analysis\n    ports:\n      - \"8888:8888\"\n    volumes:\n      # Mount Docker socket for DooD\n      - /var/run/docker.sock:/var/run/docker.sock\n      # Mount analysis directories\n      - ./data:/data:rw\n      - ./notebooks:/notebooks:rw\n      - ./output:/output:rw\n    environment:\n      - JUPYTER_ENABLE_LAB=yes\n    command: >\n      jupyter lab \n      --ip=0.0.0.0 \n      --port=8888 \n      --allow-root \n      --no-browser\n    restart: unless-stopped\n"})}),"\n",(0,s.jsx)(n.h2,{id:"5-setting-up-code-server-with-dood",children:"5. Setting Up Code Server with DooD"}),"\n",(0,s.jsx)(n.h3,{id:"51-running-code-server-with-docker-socket-mount",children:"5.1. Running Code Server with Docker Socket Mount"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Code Server with full Docker access:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"#!/bin/bash\ndocker run \\\n  --rm \\\n  -p 8443:8443 \\\n  -e PASSWORD=mypassword \\\n  -v /var/run/docker.sock:/var/run/docker.sock \\\n  -v /home/user/workspace:/home/coder/project \\\n  -v /home/user/data:/data \\\n  codercom/code-server:latest\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Access at:"})," ",(0,s.jsx)(n.a,{href:"https://localhost:8443",children:"https://localhost:8443"})]}),"\n",(0,s.jsx)(n.h3,{id:"52-using-docker-from-code-server",children:"5.2. Using Docker from Code Server"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Integrated terminal for Docker commands:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"# In Code Server terminal\ndocker ps\ndocker pull quay.io/biocontainers/nextflow:latest\ndocker run --rm quay.io/biocontainers/nextflow:latest nextflow --version\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Running and debugging Nextflow workflows:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'# In Code Server terminal - edit Nextflow script\ncat > /workspace/main.nf << \'EOF\'\nprocess alignment {\n  container \'quay.io/biocontainers/bwa:latest\'\n  input:\n  path reference\n  path reads\n  \n  output:\n  path "*.sam"\n  \n  script:\n  """\n  bwa mem $reference $reads > aligned.sam\n  """\n}\nEOF\n\n# Run workflow locally with Docker\nnextflow run main.nf -with-docker\n'})}),"\n",(0,s.jsx)(n.h3,{id:"53-docker-compose-configuration-for-code-server",children:"5.3. Docker Compose Configuration for Code Server"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"version: '3.8'\n\nservices:\n  code-server:\n    image: codercom/code-server:latest\n    container_name: code-server-dev\n    ports:\n      - \"8443:8443\"\n    environment:\n      - PASSWORD=secure_password\n      - SUDO_PASSWORD=secure_password\n    volumes:\n      # Mount Docker socket for DooD\n      - /var/run/docker.sock:/var/run/docker.sock\n      # Mount workspace\n      - ./workspace:/home/coder/project:rw\n      - ./data:/data:rw\n    restart: unless-stopped\n"})}),"\n",(0,s.jsx)(n.h2,{id:"6-complete-multi-app-setup-with-docker-compose",children:"6. Complete Multi-App Setup with Docker Compose"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Run RStudio, JupyterLab, and Code Server together:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:'version: \'3.8\'\n\nservices:\n  rstudio:\n    image: rocker/tidyverse:4.3.0\n    container_name: rstudio\n    ports:\n      - "8787:8787"\n    environment:\n      - PASSWORD=rstudio_password\n    volumes:\n      - /var/run/docker.sock:/var/run/docker.sock\n      - ./data:/data:rw\n      - ./workspace:/workspace:rw\n    restart: unless-stopped\n\n  jupyter:\n    image: jupyter/scipy-notebook:latest\n    container_name: jupyter\n    ports:\n      - "8888:8888"\n    volumes:\n      - /var/run/docker.sock:/var/run/docker.sock\n      - ./data:/data:rw\n      - ./notebooks:/notebooks:rw\n    command: >\n      jupyter lab \n      --ip=0.0.0.0 \n      --allow-root \n      --no-browser\n    restart: unless-stopped\n\n  code-server:\n    image: codercom/code-server:latest\n    container_name: code-server\n    ports:\n      - "8443:8443"\n    environment:\n      - PASSWORD=code_password\n    volumes:\n      - /var/run/docker.sock:/var/run/docker.sock\n      - ./workspace:/home/coder/project:rw\n      - ./data:/data:rw\n    restart: unless-stopped\n\n  # Optional: shared data volume container\n  data:\n    image: alpine:latest\n    volumes:\n      - ./data:/data:rw\n    command: /bin/sh -c "echo \'Data container for shared volumes\'"\n'})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Run all services:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"docker-compose up -d\n\n# Access:\n# RStudio: http://localhost:8787\n# JupyterLab: http://localhost:8888\n# Code Server: https://localhost:8443\n"})}),"\n",(0,s.jsx)(n.h2,{id:"7-important-considerations-for-dood",children:"7. Important Considerations for DooD"}),"\n",(0,s.jsx)(n.h3,{id:"71-security-considerations",children:"7.1. Security Considerations"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"File Permissions:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"#!/bin/bash\n# Files created in Docker containers may have root ownership\n# Run containers with explicit user mapping\n\ndocker run \\\n  -u $(id -u):$(id -g) \\  # Run as host user\n  -v /var/run/docker.sock:/var/run/docker.sock \\\n  -v /data:/data \\\n  ubuntu:22.04 \\\n  touch /data/file.txt\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Docker Daemon Access:"})}),"\n",(0,s.jsxs)(n.p,{children:["\u26a0\ufe0f ",(0,s.jsx)(n.strong,{children:"Warning"}),": Mounting ",(0,s.jsx)(n.code,{children:"/var/run/docker.sock"})," allows full Docker daemon access. Only do this in:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Development environments"}),"\n",(0,s.jsx)(n.li,{children:"Trusted internal systems"}),"\n",(0,s.jsx)(n.li,{children:"Your own workstation"}),"\n",(0,s.jsx)(n.li,{children:"Controlled team environments"}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["\u26a0\ufe0f ",(0,s.jsx)(n.strong,{children:"Do NOT"})," expose this to untrusted users or the public internet."]}),"\n",(0,s.jsx)(n.h3,{id:"72-resource-management",children:"7.2. Resource Management"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Limit container resources:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"docker run \\\n  --cpus 4 \\\n  --memory 16g \\\n  -v /var/run/docker.sock:/var/run/docker.sock \\\n  rocker/tidyverse:latest\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"In docker-compose:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"services:\n  rstudio:\n    image: rocker/tidyverse:latest\n    deploy:\n      resources:\n        limits:\n          cpus: '4'\n          memory: 16G\n        reservations:\n          cpus: '2'\n          memory: 8G\n"})}),"\n",(0,s.jsx)(n.h3,{id:"73-volume-management",children:"7.3. Volume Management"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Best practices for shared volumes:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"#!/bin/bash\n# Create named volume for data persistence\ndocker volume create analysis-data\n\n# Mount in multiple containers\ndocker run -v analysis-data:/data rstudio\ndocker run -v analysis-data:/data jupyter\ndocker run -v analysis-data:/data code-server\n"})}),"\n",(0,s.jsx)(n.h2,{id:"8-troubleshooting",children:"8. Troubleshooting"}),"\n",(0,s.jsx)(n.h3,{id:"81-docker-socket-permission-denied",children:"8.1. Docker Socket Permission Denied"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Problem:"})," ",(0,s.jsx)(n.code,{children:"Cannot connect to Docker daemon"})]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Solution:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"# Check Docker socket permissions\nls -la /var/run/docker.sock\n\n# Add current user to docker group\nsudo usermod -aG docker $USER\nnewgrp docker\n\n# Or run container with docker group\ndocker run \\\n  --group-add $(getent group docker | cut -d: -f3) \\\n  -v /var/run/docker.sock:/var/run/docker.sock \\\n  rocker/tidyverse:latest\n"})}),"\n",(0,s.jsx)(n.h3,{id:"82-file-permission-issues",children:"8.2. File Permission Issues"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Problem:"})," Cannot modify files created by Docker containers"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Solution:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"# Run containers with user/group mapping\ndocker run \\\n  -u $(id -u):$(id -g) \\\n  -v /var/run/docker.sock:/var/run/docker.sock \\\n  -v /data:/data \\\n  rocker/tidyverse:latest\n"})}),"\n",(0,s.jsx)(n.h3,{id:"83-volume-mount-not-visible",children:"8.3. Volume Mount Not Visible"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Problem:"})," Files in mounted volumes aren't visible from web app"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Solution:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"# Verify volume is mounted\ndocker inspect rstudio-container | grep Mounts\n\n# Use absolute paths\ndocker run \\\n  -v /home/user/data:/data \\  # Full path required\n  -v /var/run/docker.sock:/var/run/docker.sock \\\n  rocker/tidyverse:latest\n"})}),"\n",(0,s.jsx)(n.h2,{id:"9-summary",children:"9. Summary"}),"\n",(0,s.jsx)(n.p,{children:"Docker out of Docker is the ideal approach for running interactive web applications that need to spawn containerized bioinformatics tools. It provides:"}),"\n",(0,s.jsxs)(n.p,{children:["\u2705 ",(0,s.jsx)(n.strong,{children:"Performance"})," - No nested daemon overhead"]}),"\n",(0,s.jsxs)(n.p,{children:["\u2705 ",(0,s.jsx)(n.strong,{children:"Simplicity"})," - Just mount the Docker socket"]}),"\n",(0,s.jsxs)(n.p,{children:["\u2705 ",(0,s.jsx)(n.strong,{children:"Functionality"})," - Full Docker CLI access from within the web app"]}),"\n",(0,s.jsxs)(n.p,{children:["\u2705 ",(0,s.jsx)(n.strong,{children:"Data Sharing"})," - Seamless volume access between containers"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Key Points:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Mount ",(0,s.jsx)(n.code,{children:"/var/run/docker.sock"})," to enable DooD"]}),"\n",(0,s.jsx)(n.li,{children:"Mount data volumes for file sharing"}),"\n",(0,s.jsx)(n.li,{children:"Use for RStudio, JupyterLab, Code Server workflows"}),"\n",(0,s.jsx)(n.li,{children:"Perfect for local development and trusted team environments"}),"\n",(0,s.jsx)(n.li,{children:"Combine with docker-compose for multi-app setups"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"Start with the simple examples in this post, and scale up to complex multi-container bioinformatics workflows!"}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Related Reading:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"/blog/containers-hpc-docker-singularity-apptainer",children:"Containers on HPC: From Docker to Singularity and Apptainer"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://www.nextflow.io/docs/latest/container.html",children:"Nextflow Best Practices"})}),"\n"]})]})}function u(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},9831(e,n,r){r.d(n,{A:()=>o});const o=r.p+"assets/images/intro-7aaa912f8e48c1bb524eacaf56d8a3cd.png"},8453(e,n,r){r.d(n,{R:()=>t,x:()=>a});var o=r(6540);const s={},i=o.createContext(s);function t(e){const n=o.useContext(i);return o.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:t(e.components),o.createElement(i.Provider,{value:n},e.children)}},7287(e){e.exports=JSON.parse('{"permalink":"/river-docs/blog/docker-out-docker-bioinformatics-web-apps","source":"@site/blog/2026-02/2026-02-14-docker-in-docker-docker-out-docker.md","title":"Docker Out of Docker: Running Interactive Web Applications for Data Analysis","description":"Running interactive web applications like RStudio, JupyterLab, and Code Server in containers is a powerful way to provide reproducible analysis environments. However, users often need to spawn additional containerized tools from within these applications. Docker out of Docker (DooD) elegantly solves this by allowing containers to access the host\'s Docker daemon. This post explains how to set up DooD for interactive web applications and why it\'s the right approach for bioinformatics workflows.","date":"2026-02-14T00:00:00.000Z","tags":[{"inline":true,"label":"docker","permalink":"/river-docs/blog/tags/docker"},{"inline":true,"label":"containers","permalink":"/river-docs/blog/tags/containers"},{"inline":true,"label":"rstudio","permalink":"/river-docs/blog/tags/rstudio"},{"inline":true,"label":"jupyterlab","permalink":"/river-docs/blog/tags/jupyterlab"},{"inline":true,"label":"code-server","permalink":"/river-docs/blog/tags/code-server"},{"inline":true,"label":"bioinformatics","permalink":"/river-docs/blog/tags/bioinformatics"},{"inline":true,"label":"reproducibility","permalink":"/river-docs/blog/tags/reproducibility"},{"inline":true,"label":"web-apps","permalink":"/river-docs/blog/tags/web-apps"}],"readingTime":9.24,"hasTruncateMarker":true,"authors":[{"name":"Thanh-Giang Tan Nguyen","title":"Founder at RIVER","url":"https://www.facebook.com/nttg8100","page":{"permalink":"/river-docs/blog/authors/river"},"email":"nttg8100@gmail.com","socials":{"linkedin":"https://www.linkedin.com/in/thanh-giang-tan-nguyen-761b28190/","github":"https://github.com/nttg8100"},"imageURL":"https://avatars.githubusercontent.com/u/64969412?v=4","key":"river"}],"frontMatter":{"slug":"docker-out-docker-bioinformatics-web-apps","title":"Docker Out of Docker: Running Interactive Web Applications for Data Analysis","authors":["river"],"tags":["docker","containers","rstudio","jupyterlab","code-server","bioinformatics","reproducibility","web-apps"],"image":"./imgs/intro.png"},"unlisted":false,"nextItem":{"title":"Containers on HPC: From Docker to Singularity and Apptainer","permalink":"/river-docs/blog/containers-hpc-docker-singularity-apptainer"}}')}}]);