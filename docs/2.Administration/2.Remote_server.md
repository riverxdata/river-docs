# Remote Server
What is SSH ?
<div style={{ position: "relative", paddingBottom: "56.25%", height: 0, overflow: "hidden", maxWidth: "100%", background: "#000" }}>
  <iframe 
     src="https://www.youtube.com/embed/5JvLV2-ngCI" 
    frameBorder="0" 
    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
    allowFullScreen
    style={{ position: "absolute", top: 0, left: 0, width: "100%", height: "100%" }}
  />
</div>
## **Why Use a Remote Server or Cluster Instead of a Laptop?**
The server or cluster (the combinations of multiple servers (nodes)) that will allow to scheduled and executed parrallel tasks, sharing the resources via network.
Running computational workloads on a remote server or cluster is essential for performance, scalability, and reliability. Hereâ€™s why:
### **Illustration of Remote Server Setup**

<figure markdown="span">
  ![cluster](./images/remote_server.webp)
</figure>
# **Remote Server Usage Guide**

### **1. Performance & Scalability**
- Remote servers have more **CPU cores, RAM, and GPU power** than a laptop.
- High-performance clusters (HPC) are optimized for **parallel processing** and large-scale computations.

### **2. Stability & Reliability**
- Local laptops can overheat, crash, or run out of memory during intensive tasks.
- Remote servers ensure **continuous operation** without interruptions.

### **3. Storage & Data Management**
- Servers provide **large-scale storage** with fast read/write speeds.
- Data backups and **redundancy** prevent data loss.

### **4. Network & Security**
- High-speed networking enables **faster data transfers** and remote access.
- Servers are **secured and maintained** by IT teams, reducing the risk of system failure.

### **5. Reproducibility & Collaboration**
- Remote environments allow multiple users to work on **the same data and software**.
- Consistent software versions ensure **reproducible** research and analysis.

---

## **How to Access the Remote Server**
### **1. Login via SSH**
To connect to the remote server, use SSH (Secure Shell) from your terminal:

```bash
ssh username@server_address
```

- Replace `username` with your actual **username**.
- Replace `server_address` with the **IP or domain name** of the server.

Example:

```bash
ssh user123@hpc.example.com
```

### **2. Using SSH Keys (Recommended)**
For password-less authentication, generate an SSH key pair and add your public key to the server:

```bash
ssh-keygen -t rsa -b 4096
ssh-copy-id username@server_address
```

Now, you can log in without a password.

### **3. Connecting via VPN (if required)**
Some servers require a VPN connection for security. If so, connect using your institution's **VPN client** before SSH.

---

## **Setting Up SSH Server on a Remote Machine**
If the remote machine does not have SSH configured, follow these steps:

### **1. Install the SSH Server**
On most Linux distributions, install OpenSSH Server on **Ubuntu/Debian**:
```bash
sudo apt update && sudo apt install -y openssh-server
```

### **2. Enable and Start SSH Service**
Ensure the SSH service is running and enabled at boot:

```bash
sudo systemctl enable ssh
sudo systemctl start ssh
```


### **3. Configure the SSH Server (Optional)**
Edit the SSH configuration file to improve security:

```bash
sudo nano /etc/ssh/sshd_config
```
:::warning
If you want to allow for ssh service only, please do not open all ports via firewall.
:::


Recommended settings:
- Change the default port:
  ```plaintext
  Port 2222  # Change from 22 to a custom port
  ```
- Disable root login:
  ```plaintext
  PermitRootLogin no
  ```
- Allow only specific users:
  ```plaintext
  AllowUsers your_username
  ```

Save the file and restart SSH:
:::warning
New configuration requires to restart ssh service
:::

```bash
sudo systemctl restart ssh
```

### **4. Allow SSH Through the Firewall**
- **Ubuntu/Debian**:
  ```bash
  sudo ufw allow 22/tcp
  sudo ufw reload
  ```

- **CentOS/RHEL**:
  ```bash
  sudo firewall-cmd --add-service=ssh --permanent
  sudo firewall-cmd --reload
  ```

### **5. Verify SSH is Running**
Check the SSH service status:

```bash
sudo systemctl status ssh
```

Or test from another machine:

```bash
ssh username@server_ip
```

### **5. Advanced SSH Server Setup**

Using only password authentication without restrictions on the number of attempts and sessions can expose the server to brute-force attacks. To enhance security, it is recommended to use OTP (One-Time Password) for the first login, followed by RSA key authentication for subsequent logins.

For detailed instructions, refer to the following tutorials:

- **Setup the SSH Server**: This guide explains how to set up an SSH server in a Docker container, allowing for easy cleanup after use.
    [**Running SSH Server in a Docker Container**](https://satvikakolisetty.medium.com/running-ssh-server-in-a-docker-container-55eb2a3add35)

- **Set Up 2FA**: This tutorial covers using Google Authenticator and other 2FA apps like Authy for two-factor authentication. Ensure to keep the QR code and the generated code from the last step to provide to new users along with their password.
    [**SSH 2FA Tutorial**](https://goteleport.com/blog/ssh-2fa-tutorial/)


## **Basic Commands for Remote Usage**
:::info
It requires to install ssh-client
:::

The ssh-client may not availble on your laptop. You can follow this to setup 
```bash
sudo apt-get update -y && apt-get install openssh-client -y
```
Once logged in, here are some useful commands:

### Check system resources:  
  ```bash
  htop   # View CPU & memory usage
  nvidia-smi  # Check GPU status (if available)
  ```

### Transfer files:  
  ```bash
  scp localfile.txt username@server_address:/path/to/destination
  ```
### **SSH Tunneling**
SSH tunneling can be used to securely forward network traffic. There are two main types of tunnels: remote and local. Replace `username` and `domain` with your actual username and the domain of the server.

#### **Remote Tunnel**
A remote tunnel forwards a port from the remote server to your local machine. This is useful when you want to access a service running on your local machine from the remote server.

```bash
ssh -N -R 9000:localhost:9999 username@domain
```

**Example Use Case:**
You have a Jupyter Notebook running on your local machine (port 9999) and you want to access it from the remote server on port 9000.

#### **Local Tunnel**
A local tunnel forwards a port from your local machine to the remote server. This is useful when you want to access a service running on the remote server from your local machine.

```bash
ssh -N -L 9000:localhost:9999 username@domain
```

**Example Use Case:**
You have a web application running on the local machine (port 9000) and you want to access it on the server using port 9999

### Submit jobs to a cluster (SLURM example):
It is simple example on how to use SLURM, for details, follow HPC section 
+ Non interactive jobs: Job will be finished when completed or failed
   
  ```bash
  sbatch job_script.sh
  squeue -u username  
  ```

+ Interactive job: Interact with a source directly via terminal. It is finished when timeout or termianted by users
  ```bash
  srun --pty bash
  ```
---

## **Conclusion**
Using a remote server ensures **faster processing, reliable storage, and scalable computing power**, making it the best choice for resource-intensive tasks. Always follow best practices for **security and efficient resource usage**.

---
